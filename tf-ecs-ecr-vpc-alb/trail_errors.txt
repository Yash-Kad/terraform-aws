┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ alias tf="terraform"                                                                                                                                      
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker imges 
docker: unknown command: docker imges

Run 'docker --help' for more information
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker images
REPOSITORY                                                       TAG       IMAGE ID       CREATED         SIZE
107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend   latest    d8e6a40a34b7   10 hours ago    206MB
express-frontend                                                 latest    d8e6a40a34b7   10 hours ago    206MB
107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend      latest    b32fd39f376d   10 hours ago    141MB
flask-backend                                                    latest    b32fd39f376d   10 hours ago    141MB
kindest/node                                                     <none>    17b4349087dd   4 weeks ago     935MB
mongo-express                                                    latest    870141b735e7   22 months ago   182MB
mongo                                                            4.4.0     409c3f937574   5 years ago     493MB
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker ps    
CONTAINER ID   IMAGE                  COMMAND                  CREATED      STATUS         PORTS                       NAMES
db8151e15795   kindest/node:v1.35.0   "/usr/local/bin/entr…"   2 days ago   Up 2 minutes   127.0.0.1:35093->6443/tcp   fenrir-control-plane
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kind delete cluster                                                                       
Deleting cluster "kind" ...
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kind get cluster                 
Gets one of [clusters, nodes, kubeconfig]

Usage:
  kind get [flags]
  kind get [command]

Available Commands:
  clusters    Lists existing kind clusters by their name
  kubeconfig  Prints cluster kubeconfig
  nodes       Lists existing kind nodes by their name

Flags:
  -h, --help   help for get

Global Flags:
  -q, --quiet             silence all stderr output
  -v, --verbosity int32   info log verbosity, higher value produces more output

Use "kind get [command] --help" for more information about a command.
ERROR: Subcommand is required
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kind get clusters
fenrir
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kind delete fenrir 
Deletes one of [cluster]

Usage:
  kind delete [flags]
  kind delete [command]

Available Commands:
  cluster     Deletes a cluster
  clusters    Deletes one or more clusters

Flags:
  -h, --help   help for delete

Global Flags:
  -q, --quiet             silence all stderr output
  -v, --verbosity int32   info log verbosity, higher value produces more output

Use "kind delete [command] --help" for more information about a command.
ERROR: Subcommand is required
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kind delete cluster fenrir
ERROR: unknown command "fenrir" for "kind delete cluster"
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kind delete cluster --name fenrir
Deleting cluster "fenrir" ...
Deleted nodes: ["fenrir-control-plane"]
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kind get clusters                
No kind clusters found.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ kubens                                                                                   
error: current-context is not set
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker images
REPOSITORY                                                       TAG       IMAGE ID       CREATED         SIZE
107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend   latest    d8e6a40a34b7   10 hours ago    206MB
express-frontend                                                 latest    d8e6a40a34b7   10 hours ago    206MB
107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend      latest    b32fd39f376d   10 hours ago    141MB
flask-backend                                                    latest    b32fd39f376d   10 hours ago    141MB
kindest/node                                                     <none>    17b4349087dd   4 weeks ago     935MB
mongo-express                                                    latest    870141b735e7   22 months ago   182MB
mongo                                                            4.4.0     409c3f937574   5 years ago     493MB
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker ps    
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker ps -a
CONTAINER ID   IMAGE           COMMAND                  CREATED        STATUS                      PORTS     NAMES
b20a6a134eb8   9d10b9bbb8a9    "docker-entrypoint.s…"   36 hours ago   Exited (1) 36 hours ago               eager_knuth
2c780e30ded7   d7c32cde60fe    "docker-entrypoint.s…"   36 hours ago   Exited (1) 36 hours ago               k8s-assignment-frontend-1
16c68ffed4e7   add23ea76ea1    "python app.py"          36 hours ago   Exited (137) 36 hours ago             k8s-assignment-backend-1
fc112c0358ca   mongo-express   "/sbin/tini -- /dock…"   2 days ago     Exited (130) 2 days ago               nostalgic_dijkstra
dd15f88e6c5e   mongo-express   "/sbin/tini -- /dock…"   2 days ago     Exited (1) 2 days ago                 upbeat_meitner
089c1f055c77   mongo:4.4.0     "docker-entrypoint.s…"   2 days ago     Exited (0) 44 hours ago               frosty_ritchie
0feddff853f2   252af33466de    "docker-entrypoint.s…"   2 days ago     Exited (132) 2 days ago               tender_colden
4dfb7e759137   mongo:4.4.0     "docker-entrypoint.s…"   2 days ago     Exited (0) 2 days ago                 awesome_grothendieck
c4fc7af7c8a6   252af33466de    "docker-entrypoint.s…"   2 days ago     Exited (132) 2 days ago               vigilant_jennings
66681eba50d7   252af33466de    "docker-entrypoint.s…"   2 days ago     Exited (132) 2 days ago               condescending_margulis
3a8ad0f7f08e   e61153aa6186    "python3 app.py"         10 days ago    Exited (0) 10 days ago                agitated_knuth
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker run -it b32fd39f376d 
[2026-01-15 04:56:49 +0000] [1] [INFO] Starting gunicorn 23.0.0
[2026-01-15 04:56:49 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)
[2026-01-15 04:56:49 +0000] [1] [INFO] Using worker: sync
[2026-01-15 04:56:49 +0000] [8] [INFO] Booting worker with pid: 8
^C[2026-01-15 04:57:24 +0000] [1] [INFO] Handling signal: int
[2026-01-15 04:57:24 +0000] [8] [INFO] Worker exiting (pid: 8)
[2026-01-15 04:57:25 +0000] [1] [INFO] Shutting down: Master
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker run -it -p 8000:8000 b32fd39f376d
[2026-01-15 04:57:44 +0000] [1] [INFO] Starting gunicorn 23.0.0
[2026-01-15 04:57:44 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)
[2026-01-15 04:57:44 +0000] [1] [INFO] Using worker: sync
[2026-01-15 04:57:44 +0000] [7] [INFO] Booting worker with pid: 7
[2026-01-15 04:58:30 +0000] [1] [INFO] Handling signal: winch
[2026-01-15 04:58:30 +0000] [1] [INFO] Handling signal: winch
[2026-01-15 05:23:14 +0000] [1] [INFO] Handling signal: term
[2026-01-15 05:23:14 +0000] [7] [INFO] Worker exiting (pid: 7)
[2026-01-15 05:23:15 +0000] [1] [INFO] Shutting down: Master
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ 


























┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ ls
alb.tf  backend  ecs.tf  frontend  main.tf  terraform.tfstate  terraform.tfstate.backup  terraform.tfvars  variables.tf
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf init   

Initializing the backend...

Initializing provider plugins...
- Reusing previous version of hashicorp/aws from the dependency lock file
- Using previously-installed hashicorp/aws v6.28.0

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ terraform apply -target=aws_ecr_repository.backend -target=aws_ecr_repository.frontend -auto-approve

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # aws_ecr_repository.backend will be created
  + resource "aws_ecr_repository" "backend" {
      + arn                  = (known after apply)
      + force_delete         = true
      + id                   = (known after apply)
      + image_tag_mutability = "MUTABLE"
      + name                 = "flask-backend"
      + region               = "ap-south-1"
      + registry_id          = (known after apply)
      + repository_url       = (known after apply)
      + tags_all             = (known after apply)
    }

  # aws_ecr_repository.frontend will be created
  + resource "aws_ecr_repository" "frontend" {
      + arn                  = (known after apply)
      + force_delete         = true
      + id                   = (known after apply)
      + image_tag_mutability = "MUTABLE"
      + name                 = "express-frontend"
      + region               = "ap-south-1"
      + registry_id          = (known after apply)
      + repository_url       = (known after apply)
      + tags_all             = (known after apply)
    }

Plan: 2 to add, 0 to change, 0 to destroy.
aws_ecr_repository.backend: Creating...
aws_ecr_repository.frontend: Creating...
aws_ecr_repository.backend: Creation complete after 0s [id=flask-backend]
aws_ecr_repository.frontend: Creation complete after 0s [id=express-frontend]
╷
│ Warning: Resource targeting is in effect
│ 
│ You are creating a plan with the -target option, which means that the result of this plan may not represent all of the changes requested by the current configuration.
│ 
│ The -target option is not for routine use, and is provided only for exceptional situations such as recovering from errors or mistakes, or when Terraform specifically suggests to use it as part of an error message.
╵
╷
│ Warning: Applied changes may be incomplete
│ 
│ The plan was created with the -target option in effect, so some changes requested in the configuration may have been ignored and the output values may not be fully updated. Run the following command to verify that no other changes
│ are pending:
│     terraform plan
│ 
│ Note that the -target option is not suitable for routine use, and is provided only for exceptional situations such as recovering from errors or mistakes, or when Terraform specifically suggests to use it as part of an error message.
╵

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.                                                                                                                                                                                 
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ cd backend                                                                                          
docker build -t flask-backend .
docker tag flask-backend:latest 107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend:latest
docker push 107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend:latest
cd ..    
ERROR: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ aws configure                                                                                                                                             
AWS Access Key ID [****************FG4S]: 
AWS Secret Access Key [****************cntb]: 
Default region name [ap-south-1]: 
Default output format [json]: 
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ aws configure
AWS Access Key ID [****************FG4S]: 
AWS Secret Access Key [****************cntb]: 
Default region name [ap-south-1]: 
Default output format [json]: 
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ aws ecr get-login-password --region ap-south-1 | docker login --username AWS --password-stdin 107634107029.dkr.ecr.ap-south-1.amazonaws.com
WARNING! Your password will be stored unencrypted in /home/kali/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credential-stores

Login Succeeded
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf apply -target=aws_ecr_repository.backend -target=aws_ecr_repository.frontend
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]

No changes. Your infrastructure matches the configuration.

Terraform has compared your real infrastructure against your configuration and found no differences, so no changes are needed.
╷
│ Warning: Resource targeting is in effect
│ 
│ You are creating a plan with the -target option, which means that the result of this plan may not represent all of the changes requested by the current configuration.
│ 
│ The -target option is not for routine use, and is provided only for exceptional situations such as recovering from errors or mistakes, or when Terraform specifically suggests to use it as part of an error message.
╵
╷
│ Warning: Applied changes may be incomplete
│ 
│ The plan was created with the -target option in effect, so some changes requested in the configuration may have been ignored and the output values may not be fully updated. Run the following command to verify that no other changes
│ are pending:
│     terraform plan
│ 
│ Note that the -target option is not suitable for routine use, and is provided only for exceptional situations such as recovering from errors or mistakes, or when Terraform specifically suggests to use it as part of an error message.
╵

Apply complete! Resources: 0 added, 0 changed, 0 destroyed.                                                                                                                                                                                 
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ cd backend                                                                                                                                 
docker build -t flask-backend .
docker tag flask-backend:latest 107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend:latest
docker push 107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend:latest
cd ..
ERROR: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ sudo systemctl status docker
[sudo] password for kali: 
Unit docker.service could not be found.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ docker --version                        
Docker version 27.5.1+dfsg4, build cab968b3
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ sudo systemctl start docker
Failed to start docker.service: Unit docker.service not found.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ sudo apt update               
Get:1 https://download.docker.com/linux/debian bookworm InRelease [46.6 kB]
Get:2 https://download.docker.com/linux/debian bookworm/stable amd64 Packages [59.1 kB]                                                                             
Get:3 http://kali.download/kali kali-rolling InRelease [34.0 kB]                                                                          
Get:4 http://kali.download/kali kali-rolling/main amd64 Packages [20.9 MB]                                           
Ign:5 https://apt.releases.hashicorp.com kali-rolling InRelease                                                    
Hit:6 https://ngrok-agent.s3.amazonaws.com bookworm InRelease                                                      
Err:7 https://apt.releases.hashicorp.com kali-rolling Release
  404  Not Found [IP: 18.172.78.65 443]
Get:8 http://kali.download/kali kali-rolling/main amd64 Contents (deb) [52.5 MB]
Get:9 http://kali.download/kali kali-rolling/contrib amd64 Packages [115 kB]                                                                                                                                                               
Get:10 http://kali.download/kali kali-rolling/non-free amd64 Packages [190 kB]                                                                                                                                                             
Get:11 http://kali.download/kali kali-rolling/non-free amd64 Contents (deb) [905 kB]                                                                                                                                                       
Error: The repository 'https://apt.releases.hashicorp.com kali-rolling Release' does not have a Release file.                                                                                                                              
Notice: Updating from such a repository can't be done securely, and is therefore disabled by default.
Notice: See apt-secure(8) manpage for repository creation and user configuration details.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ sudo apt install -y docker.io
The following packages were automatically installed and are no longer required:
  libslirp0  pigz  slirp4netns
Use 'sudo apt autoremove' to remove them.

Installing:
  docker.io
                                                                                                                                                                                                                                            
Installing dependencies:
  containerd  criu  libcompel1  libintl-perl  libintl-xs-perl  libmodule-find-perl  libnet9  libproc-processtable-perl  libsort-naturally-perl  needrestart  python3-pycriu  runc  tini-static
                                                                                                                                                                                                                                            
Suggested packages:
  containernetworking-plugins  docker-doc  btrfs-progs  debootstrap  rinse  rootlesskit  xfsprogs  zfs-fuse  | zfsutils-linux

REMOVING:
  containerd.io  docker-ce-rootless-extras
                                                                                                                                                                                                                                            
Summary:
  Upgrading: 0, Installing: 14, Removing: 2, Not Upgrading: 1373
  1 not fully installed or removed.
  Download size: 65.3 MB
  Space needed: 117 MB / 48.8 GB available

Get:1 http://http.kali.org/kali kali-rolling/main amd64 runc amd64 1.3.3+ds1-2 [6,686 kB]
Get:3 http://kali.download/kali kali-rolling/main amd64 tini-static amd64 0.19.0-6 [277 kB]
Get:4 http://http.kali.org/kali kali-rolling/main amd64 docker.io amd64 27.5.1+dfsg4-1 [23.2 MB]
Get:2 http://http.kali.org/kali kali-rolling/main amd64 containerd amd64 1.7.24~ds1-10 [33.6 MB]
Get:5 http://http.kali.org/kali kali-rolling/main amd64 libnet9 amd64 1.3+dfsg-3 [51.3 kB]
Get:6 http://kali.download/kali kali-rolling/main amd64 libcompel1 amd64 4.2-1 [64.2 kB]
Get:7 http://kali.download/kali kali-rolling/main amd64 criu amd64 4.2-1 [557 kB]
Get:8 http://kali.download/kali kali-rolling/main amd64 libintl-perl all 1.35-1 [690 kB]
Get:9 http://kali.download/kali kali-rolling/main amd64 libintl-xs-perl amd64 1.35-1 [15.3 kB]
Get:10 http://kali.download/kali kali-rolling/main amd64 libmodule-find-perl all 0.17-1 [10.7 kB]
Get:13 http://kali.download/kali kali-rolling/main amd64 needrestart all 3.11-1 [68.6 kB]
Get:14 http://kali.download/kali kali-rolling/main amd64 python3-pycriu all 4.2-1 [44.3 kB]
Get:11 http://mirrors.esto.network/kali kali-rolling/main amd64 libproc-processtable-perl amd64 0.637-1 [42.1 kB]                                                                                                                          
Get:12 http://mirrors.esto.network/kali kali-rolling/main amd64 libsort-naturally-perl all 1.03-4 [13.1 kB]                                                                                                                                
Fetched 65.3 MB in 13s (5,002 kB/s)                                                                                                                                                                                                        
(Reading database ... 472871 files and directories currently installed.)
Removing containerd.io (1.7.28-1~debian.12~bookworm) ...
Removing docker-ce-rootless-extras (5:28.5.1-1~debian.12~bookworm) ...
Selecting previously unselected package runc.
(Reading database ... 472852 files and directories currently installed.)
Preparing to unpack .../00-runc_1.3.3+ds1-2_amd64.deb ...
Unpacking runc (1.3.3+ds1-2) ...
Selecting previously unselected package containerd.
Preparing to unpack .../01-containerd_1.7.24~ds1-10_amd64.deb ...
Unpacking containerd (1.7.24~ds1-10) ...
Selecting previously unselected package tini-static.
Preparing to unpack .../02-tini-static_0.19.0-6_amd64.deb ...
Unpacking tini-static (0.19.0-6) ...
Selecting previously unselected package docker.io.
Preparing to unpack .../03-docker.io_27.5.1+dfsg4-1_amd64.deb ...
Unpacking docker.io (27.5.1+dfsg4-1) ...
Selecting previously unselected package libnet9:amd64.
Preparing to unpack .../04-libnet9_1.3+dfsg-3_amd64.deb ...
Unpacking libnet9:amd64 (1.3+dfsg-3) ...
Selecting previously unselected package libcompel1:amd64.
Preparing to unpack .../05-libcompel1_4.2-1_amd64.deb ...
Unpacking libcompel1:amd64 (4.2-1) ...
Selecting previously unselected package criu.
Preparing to unpack .../06-criu_4.2-1_amd64.deb ...
Unpacking criu (4.2-1) ...
Selecting previously unselected package libintl-perl.
Preparing to unpack .../07-libintl-perl_1.35-1_all.deb ...
Unpacking libintl-perl (1.35-1) ...
Selecting previously unselected package libintl-xs-perl.
Preparing to unpack .../08-libintl-xs-perl_1.35-1_amd64.deb ...
Unpacking libintl-xs-perl (1.35-1) ...
Selecting previously unselected package libmodule-find-perl.
Preparing to unpack .../09-libmodule-find-perl_0.17-1_all.deb ...
Unpacking libmodule-find-perl (0.17-1) ...
Selecting previously unselected package libproc-processtable-perl:amd64.
Preparing to unpack .../10-libproc-processtable-perl_0.637-1_amd64.deb ...
Unpacking libproc-processtable-perl:amd64 (0.637-1) ...
Selecting previously unselected package libsort-naturally-perl.
Preparing to unpack .../11-libsort-naturally-perl_1.03-4_all.deb ...
Unpacking libsort-naturally-perl (1.03-4) ...
Selecting previously unselected package needrestart.
Preparing to unpack .../12-needrestart_3.11-1_all.deb ...
Unpacking needrestart (3.11-1) ...
Selecting previously unselected package python3-pycriu.
Preparing to unpack .../13-python3-pycriu_4.2-1_all.deb ...
Unpacking python3-pycriu (4.2-1) ...
Setting up docker-cli (27.5.1+dfsg4-1) ...
Setting up tini-static (0.19.0-6) ...
Setting up runc (1.3.3+ds1-2) ...
Setting up libcompel1:amd64 (4.2-1) ...
Setting up libmodule-find-perl (0.17-1) ...
Setting up libproc-processtable-perl:amd64 (0.637-1) ...
Setting up libintl-perl (1.35-1) ...
Setting up libnet9:amd64 (1.3+dfsg-3) ...
Setting up containerd (1.7.24~ds1-10) ...
Installing new version of config file /etc/containerd/config.toml ...
containerd.service is a disabled or a static unit not running, not starting it.
Setting up libsort-naturally-perl (1.03-4) ...
Setting up needrestart (3.11-1) ...
Setting up docker.io (27.5.1+dfsg4-1) ...
Installing new version of config file /etc/default/docker ...
Installing new version of config file /etc/init.d/docker ...
Setting up libintl-xs-perl (1.35-1) ...
Setting up criu (4.2-1) ...
Setting up python3-pycriu (4.2-1) ...
Processing triggers for libc-bin (2.41-12) ...
Processing triggers for man-db (2.13.1-1) ...
Processing triggers for kali-menu (2025.4.1) ...
Scanning processes...                                                                                                                                                                                                                       
Scanning linux images...                                                                                                                                                                                                                    

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ sudo systemctl enable docker --now
Synchronizing state of docker.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable docker
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ sudo systemctl status docker
● docker.service - Docker Application Container Engine
     Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled; preset: enabled)
     Active: active (running) since Thu 2026-01-15 00:45:37 EST; 27s ago
 Invocation: 88a07f46c7dd4a54a1ea17ef46df6da8
TriggeredBy: ● docker.socket
       Docs: https://docs.docker.com
   Main PID: 13553 (dockerd)
      Tasks: 11
     Memory: 32.2M (peak: 32.6M)
        CPU: 4.079s
     CGroup: /system.slice/docker.service
             └─13553 /usr/sbin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock

Jan 15 00:45:31 kali dockerd[13553]: time="2026-01-15T00:45:31.284555625-05:00" level=info msg="Starting up"
Jan 15 00:45:31 kali dockerd[13553]: time="2026-01-15T00:45:31.287939894-05:00" level=info msg="OTEL tracing is not configured, using no-op tracer provider"
Jan 15 00:45:31 kali dockerd[13553]: time="2026-01-15T00:45:31.744492174-05:00" level=info msg="[graphdriver] using prior storage driver: overlay2"
Jan 15 00:45:32 kali dockerd[13553]: time="2026-01-15T00:45:32.619047741-05:00" level=info msg="Loading containers: start."
Jan 15 00:45:35 kali dockerd[13553]: time="2026-01-15T00:45:35.067723890-05:00" level=info msg="Default bridge (docker0) is assigned with an IP address 172.17.0.0/16. Daemon option --bip can be used to set a preferred IP address"
Jan 15 00:45:35 kali dockerd[13553]: time="2026-01-15T00:45:35.481391890-05:00" level=info msg="Loading containers: done."
Jan 15 00:45:35 kali dockerd[13553]: time="2026-01-15T00:45:35.576120769-05:00" level=info msg="Docker daemon" commit=61416484 containerd-snapshotter=false storage-driver=overlay2 version=27.5.1+dfsg4
Jan 15 00:45:35 kali dockerd[13553]: time="2026-01-15T00:45:35.576331951-05:00" level=info msg="Daemon has completed initialization"
Jan 15 00:45:37 kali systemd[1]: Started docker.service - Docker Application Container Engine.
Jan 15 00:45:37 kali dockerd[13553]: time="2026-01-15T00:45:37.196480464-05:00" level=info msg="API listen on /run/docker.sock"
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ sudo usermod -aG docker $USER
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ newgrp docker
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ aws ecr get-login-password --region ap-south-1 | docker login --username AWS --password-stdin <YOUR_ACCOUNT_ID>.dkr.ecr.ap-south-1.amazonaws.com
zsh: no such file or directory: YOUR_ACCOUNT_ID
Exception ignored on flushing sys.stdout:
BrokenPipeError: [Errno 32] Broken pipe
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ aws ecr get-login-password --region ap-south-1 | docker login --username AWS --password-stdin 107634107029.dkr.ecr.ap-south-1.amazonaws.com
WARNING! Your password will be stored unencrypted in /home/kali/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credential-stores

Login Succeeded
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ cd backend    
docker build -t flask-backend .
docker tag flask-backend:latest 107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend:latest
docker push 107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend:latest
cd ..    
[+] Building 2.2s (11/11) FINISHED                                                                                                                                                                                           docker:default
 => [internal] load build definition from Dockerfile                                                                                                                                                                                   0.1s
 => => transferring dockerfile: 227B                                                                                                                                                                                                   0.0s
 => [internal] load metadata for docker.io/library/python:3.11-slim                                                                                                                                                                    1.8s
 => [auth] library/python:pull token for registry-1.docker.io                                                                                                                                                                          0.0s
 => [internal] load .dockerignore                                                                                                                                                                                                      0.0s
 => => transferring context: 2B                                                                                                                                                                                                        0.0s
 => [1/5] FROM docker.io/library/python:3.11-slim@sha256:c24e9effa2821a6885165d930d939fec2af0dcf819276138f11dd45e200bd032                                                                                                              0.0s
 => [internal] load build context                                                                                                                                                                                                      0.0s
 => => transferring context: 125B                                                                                                                                                                                                      0.0s
 => CACHED [2/5] WORKDIR /app                                                                                                                                                                                                          0.0s
 => CACHED [3/5] COPY requirements.txt .                                                                                                                                                                                               0.0s
 => CACHED [4/5] RUN pip install --no-cache-dir -r requirements.txt                                                                                                                                                                    0.0s
 => CACHED [5/5] COPY . .                                                                                                                                                                                                              0.0s
 => exporting to image                                                                                                                                                                                                                 0.1s
 => => exporting layers                                                                                                                                                                                                                0.0s
 => => writing image sha256:4f193a00b6434c0a1ca8f57d12aa9c871a43f72d0388301c835b787935166dd6                                                                                                                                           0.0s
 => => naming to docker.io/library/flask-backend                                                                                                                                                                                       0.0s
The push refers to repository [107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend]
c716c4afa2c2: Pushed 
f9672b0b24dc: Pushed 
bcaa4e2ffbe9: Pushed 
cd8b7b4528d6: Pushed 
49d74831a287: Pushed 
5d89b1d5fc98: Pushed 
523062ea36b5: Pushed 
e50a58335e13: Pushed 
latest: digest: sha256:c4c1fc6fd3b33078db4e5f45ba53decbd01da858412b9c4b1fd3dd3d106a18ed size: 1991
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ cd frontend 
docker build -t express-frontend .
docker tag express-frontend:latest 107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend:latest
docker push 107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend:latest
cd ..
[+] Building 7.2s (11/11) FINISHED                                                                                                                                                                                           docker:default
 => [internal] load build definition from Dockerfile                                                                                                                                                                                   0.1s
 => => transferring dockerfile: 157B                                                                                                                                                                                                   0.0s 
 => [internal] load metadata for docker.io/library/node:20-slim                                                                                                                                                                        6.7s 
 => [auth] library/node:pull token for registry-1.docker.io                                                                                                                                                                            0.0s
 => [internal] load .dockerignore                                                                                                                                                                                                      0.0s
 => => transferring context: 2B                                                                                                                                                                                                        0.0s 
 => [1/5] FROM docker.io/library/node:20-slim@sha256:6c51af7dc83f4708aaac35991306bca8f478351cfd2bda35750a62d7efcf05bb                                                                                                                  0.0s 
 => [internal] load build context                                                                                                                                                                                                      0.0s 
 => => transferring context: 188B                                                                                                                                                                                                      0.0s 
 => CACHED [2/5] WORKDIR /app                                                                                                                                                                                                          0.0s 
 => CACHED [3/5] COPY package*.json ./                                                                                                                                                                                                 0.0s 
 => CACHED [4/5] RUN npm install                                                                                                                                                                                                       0.0s 
 => CACHED [5/5] COPY . .                                                                                                                                                                                                              0.0s 
 => exporting to image                                                                                                                                                                                                                 0.1s 
 => => exporting layers                                                                                                                                                                                                                0.0s 
 => => writing image sha256:a35c1a99514e314075b1fbd5a149da5694192116550108ccc857e345b7bf8018                                                                                                                                           0.0s 
 => => naming to docker.io/library/express-frontend                                                                                                                                                                                    0.0s 
The push refers to repository [107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend]                                                                                                                                              
2fb3b46eea20: Pushed 
50dfbd14efc5: Pushed 
aba1dc847901: Pushed 
7340ce146146: Pushed 
7492c31043fa: Pushed 
00bf21304c8c: Pushed 
b051c96fe9e7: Pushed 
6de3bf4d809c: Pushed 
e0e600257047: Pushed 
latest: digest: sha256:12d71fd960b3aad3edffe84f750143d7082862f223e74c719167228a8918b876 size: 2201
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ cd frontend
docker build -t express-frontend .
docker tag express-frontend:latest 107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend:latest
docker push 107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend:latest
cd ..
[+] Building 2.0s (11/11) FINISHED                                                                                                                                                                                           docker:default
 => [internal] load build definition from Dockerfile                                                                                                                                                                                   0.0s
 => => transferring dockerfile: 157B                                                                                                                                                                                                   0.0s 
 => [internal] load metadata for docker.io/library/node:20-slim                                                                                                                                                                        1.5s 
 => [auth] library/node:pull token for registry-1.docker.io                                                                                                                                                                            0.0s
 => [internal] load .dockerignore                                                                                                                                                                                                      0.0s 
 => => transferring context: 2B                                                                                                                                                                                                        0.0s 
 => [1/5] FROM docker.io/library/node:20-slim@sha256:6c51af7dc83f4708aaac35991306bca8f478351cfd2bda35750a62d7efcf05bb                                                                                                                  0.0s 
 => [internal] load build context                                                                                                                                                                                                      0.0s 
 => => transferring context: 1.15kB                                                                                                                                                                                                    0.0s 
 => CACHED [2/5] WORKDIR /app                                                                                                                                                                                                          0.0s 
 => CACHED [3/5] COPY package*.json ./                                                                                                                                                                                                 0.0s 
 => CACHED [4/5] RUN npm install                                                                                                                                                                                                       0.0s 
 => [5/5] COPY . .                                                                                                                                                                                                                     0.1s 
 => exporting to image                                                                                                                                                                                                                 0.1s 
 => => exporting layers                                                                                                                                                                                                                0.1s 
 => => writing image sha256:2163eb475104592cd69262736b1ceaa443f89123cd3d407fe6a1494a370e22e2                                                                                                                                           0.0s 
 => => naming to docker.io/library/express-frontend                                                                                                                                                                                    0.0s 
The push refers to repository [107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend]                                                                                                                                              
11ebe5857124: Pushed 
50dfbd14efc5: Layer already exists 
aba1dc847901: Layer already exists 
7340ce146146: Layer already exists 
7492c31043fa: Layer already exists 
00bf21304c8c: Layer already exists 
b051c96fe9e7: Layer already exists 
6de3bf4d809c: Layer already exists 
e0e600257047: Layer already exists 
latest: digest: sha256:0fadbce20b5c17589ec22a93c7fb91dd08b426d6758da2e9cb0bb20e9520af64 size: 2201
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ alias tf="terraform"                                                                                                                       
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf apply -auto-approve
data.aws_availability_zones.available: Reading...
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # aws_ecs_cluster.main will be created
  + resource "aws_ecs_cluster" "main" {
      + arn      = (known after apply)
      + id       = (known after apply)
      + name     = "app-cluster"
      + region   = "ap-south-1"
      + tags_all = (known after apply)
    }

  # aws_ecs_service.backend will be created
  + resource "aws_ecs_service" "backend" {
      + arn                                = (known after apply)
      + availability_zone_rebalancing      = (known after apply)
      + cluster                            = (known after apply)
      + deployment_maximum_percent         = 200
      + deployment_minimum_healthy_percent = 100
      + desired_count                      = 1
      + enable_ecs_managed_tags            = false
      + enable_execute_command             = false
      + iam_role                           = (known after apply)
      + id                                 = (known after apply)
      + launch_type                        = "FARGATE"
      + name                               = "backend-service"
      + platform_version                   = (known after apply)
      + region                             = "ap-south-1"
      + scheduling_strategy                = "REPLICA"
      + tags_all                           = (known after apply)
      + task_definition                    = (known after apply)
      + triggers                           = (known after apply)
      + wait_for_steady_state              = false

      + network_configuration {
          + assign_public_ip = true
          + security_groups  = (known after apply)
          + subnets          = (known after apply)
        }
    }

  # aws_ecs_service.frontend will be created
  + resource "aws_ecs_service" "frontend" {
      + arn                                = (known after apply)
      + availability_zone_rebalancing      = (known after apply)
      + cluster                            = (known after apply)
      + deployment_maximum_percent         = 200
      + deployment_minimum_healthy_percent = 100
      + desired_count                      = 1
      + enable_ecs_managed_tags            = false
      + enable_execute_command             = false
      + iam_role                           = (known after apply)
      + id                                 = (known after apply)
      + launch_type                        = "FARGATE"
      + name                               = "frontend-service"
      + platform_version                   = (known after apply)
      + region                             = "ap-south-1"
      + scheduling_strategy                = "REPLICA"
      + tags_all                           = (known after apply)
      + task_definition                    = (known after apply)
      + triggers                           = (known after apply)
      + wait_for_steady_state              = false

      + load_balancer {
          + container_name   = "frontend"
          + container_port   = 3000
          + target_group_arn = (known after apply)
        }

      + network_configuration {
          + assign_public_ip = true
          + security_groups  = (known after apply)
          + subnets          = (known after apply)
        }
    }

  # aws_ecs_task_definition.backend will be created
  + resource "aws_ecs_task_definition" "backend" {
      + arn                      = (known after apply)
      + arn_without_revision     = (known after apply)
      + container_definitions    = jsonencode(
            [
              + {
                  + image        = "107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend"
                  + name         = "backend"
                  + portMappings = [
                      + {
                          + containerPort = 8000
                          + hostPort      = 8000
                        },
                    ]
                },
            ]
        )
      + cpu                      = "256"
      + enable_fault_injection   = (known after apply)
      + execution_role_arn       = (known after apply)
      + family                   = "backend-task"
      + id                       = (known after apply)
      + memory                   = "512"
      + network_mode             = "awsvpc"
      + region                   = "ap-south-1"
      + requires_compatibilities = [
          + "FARGATE",
        ]
      + revision                 = (known after apply)
      + skip_destroy             = false
      + tags_all                 = (known after apply)
      + track_latest             = false
    }

  # aws_ecs_task_definition.frontend will be created
  + resource "aws_ecs_task_definition" "frontend" {
      + arn                      = (known after apply)
      + arn_without_revision     = (known after apply)
      + container_definitions    = jsonencode(
            [
              + {
                  + environment  = [
                      + {
                          + name  = "BACKEND_URL"
                          + value = "http://localhost:8000/people"
                        },
                    ]
                  + image        = "107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend"
                  + name         = "frontend"
                  + portMappings = [
                      + {
                          + containerPort = 3000
                          + hostPort      = 3000
                        },
                    ]
                },
            ]
        )
      + cpu                      = "256"
      + enable_fault_injection   = (known after apply)
      + execution_role_arn       = (known after apply)
      + family                   = "frontend-task"
      + id                       = (known after apply)
      + memory                   = "512"
      + network_mode             = "awsvpc"
      + region                   = "ap-south-1"
      + requires_compatibilities = [
          + "FARGATE",
        ]
      + revision                 = (known after apply)
      + skip_destroy             = false
      + tags_all                 = (known after apply)
      + track_latest             = false
    }

  # aws_iam_role.ecs_task_execution_role will be created
  + resource "aws_iam_role" "ecs_task_execution_role" {
      + arn                   = (known after apply)
      + assume_role_policy    = jsonencode(
            {
              + Statement = [
                  + {
                      + Action    = "sts:AssumeRole"
                      + Effect    = "Allow"
                      + Principal = {
                          + Service = "ecs-tasks.amazonaws.com"
                        }
                    },
                ]
              + Version   = "2012-10-17"
            }
        )
      + create_date           = (known after apply)
      + force_detach_policies = false
      + id                    = (known after apply)
      + managed_policy_arns   = (known after apply)
      + max_session_duration  = 3600
      + name                  = "ecsTaskExecutionRoleUnique"
      + name_prefix           = (known after apply)
      + path                  = "/"
      + tags_all              = (known after apply)
      + unique_id             = (known after apply)
    }

  # aws_iam_role_policy_attachment.ecs_task_execution_role_policy will be created
  + resource "aws_iam_role_policy_attachment" "ecs_task_execution_role_policy" {
      + id         = (known after apply)
      + policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
      + role       = "ecsTaskExecutionRoleUnique"
    }

  # aws_internet_gateway.gw will be created
  + resource "aws_internet_gateway" "gw" {
      + arn      = (known after apply)
      + id       = (known after apply)
      + owner_id = (known after apply)
      + region   = "ap-south-1"
      + tags_all = (known after apply)
      + vpc_id   = (known after apply)
    }

  # aws_lb.main will be created
  + resource "aws_lb" "main" {
      + arn                                                          = (known after apply)
      + arn_suffix                                                   = (known after apply)
      + client_keep_alive                                            = 3600
      + desync_mitigation_mode                                       = "defensive"
      + dns_name                                                     = (known after apply)
      + drop_invalid_header_fields                                   = false
      + enable_deletion_protection                                   = false
      + enable_http2                                                 = true
      + enable_tls_version_and_cipher_suite_headers                  = false
      + enable_waf_fail_open                                         = false
      + enable_xff_client_port                                       = false
      + enable_zonal_shift                                           = false
      + enforce_security_group_inbound_rules_on_private_link_traffic = (known after apply)
      + id                                                           = (known after apply)
      + idle_timeout                                                 = 60
      + internal                                                     = (known after apply)
      + ip_address_type                                              = (known after apply)
      + load_balancer_type                                           = "application"
      + name                                                         = "app-lb"
      + name_prefix                                                  = (known after apply)
      + preserve_host_header                                         = false
      + region                                                       = "ap-south-1"
      + secondary_ips_auto_assigned_per_subnet                       = (known after apply)
      + security_groups                                              = (known after apply)
      + subnets                                                      = (known after apply)
      + tags_all                                                     = (known after apply)
      + vpc_id                                                       = (known after apply)
      + xff_header_processing_mode                                   = "append"
      + zone_id                                                      = (known after apply)
    }

  # aws_lb_listener.http will be created
  + resource "aws_lb_listener" "http" {
      + arn                                                                   = (known after apply)
      + id                                                                    = (known after apply)
      + load_balancer_arn                                                     = (known after apply)
      + port                                                                  = 80
      + protocol                                                              = "HTTP"
      + region                                                                = "ap-south-1"
      + routing_http_request_x_amzn_mtls_clientcert_header_name               = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_issuer_header_name        = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_leaf_header_name          = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_subject_header_name       = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_validity_header_name      = (known after apply)
      + routing_http_request_x_amzn_tls_cipher_suite_header_name              = (known after apply)
      + routing_http_request_x_amzn_tls_version_header_name                   = (known after apply)
      + routing_http_response_access_control_allow_credentials_header_value   = (known after apply)
      + routing_http_response_access_control_allow_headers_header_value       = (known after apply)
      + routing_http_response_access_control_allow_methods_header_value       = (known after apply)
      + routing_http_response_access_control_allow_origin_header_value        = (known after apply)
      + routing_http_response_access_control_expose_headers_header_value      = (known after apply)
      + routing_http_response_access_control_max_age_header_value             = (known after apply)
      + routing_http_response_content_security_policy_header_value            = (known after apply)
      + routing_http_response_server_enabled                                  = (known after apply)
      + routing_http_response_strict_transport_security_header_value          = (known after apply)
      + routing_http_response_x_content_type_options_header_value             = (known after apply)
      + routing_http_response_x_frame_options_header_value                    = (known after apply)
      + ssl_policy                                                            = (known after apply)
      + tags_all                                                              = (known after apply)
      + tcp_idle_timeout_seconds                                              = (known after apply)

      + default_action {
          + order            = (known after apply)
          + target_group_arn = (known after apply)
          + type             = "forward"
        }
    }

  # aws_lb_target_group.frontend_tg will be created
  + resource "aws_lb_target_group" "frontend_tg" {
      + arn                                = (known after apply)
      + arn_suffix                         = (known after apply)
      + connection_termination             = (known after apply)
      + deregistration_delay               = "300"
      + id                                 = (known after apply)
      + ip_address_type                    = (known after apply)
      + lambda_multi_value_headers_enabled = false
      + load_balancer_arns                 = (known after apply)
      + load_balancing_algorithm_type      = (known after apply)
      + load_balancing_anomaly_mitigation  = (known after apply)
      + load_balancing_cross_zone_enabled  = (known after apply)
      + name                               = "frontend-target-group"
      + name_prefix                        = (known after apply)
      + port                               = 3000
      + preserve_client_ip                 = (known after apply)
      + protocol                           = "HTTP"
      + protocol_version                   = (known after apply)
      + proxy_protocol_v2                  = false
      + region                             = "ap-south-1"
      + slow_start                         = 0
      + tags_all                           = (known after apply)
      + target_type                        = "ip"
      + vpc_id                             = (known after apply)

      + health_check {
          + enabled             = true
          + healthy_threshold   = 3
          + interval            = 30
          + matcher             = (known after apply)
          + path                = "/"
          + port                = "3000"
          + protocol            = "HTTP"
          + timeout             = (known after apply)
          + unhealthy_threshold = 3
        }
    }

  # aws_route.internet_access will be created
  + resource "aws_route" "internet_access" {
      + destination_cidr_block = "0.0.0.0/0"
      + gateway_id             = (known after apply)
      + id                     = (known after apply)
      + instance_id            = (known after apply)
      + instance_owner_id      = (known after apply)
      + network_interface_id   = (known after apply)
      + origin                 = (known after apply)
      + region                 = "ap-south-1"
      + route_table_id         = (known after apply)
      + state                  = (known after apply)
    }

  # aws_security_group.lb_sg will be created
  + resource "aws_security_group" "lb_sg" {
      + arn                    = (known after apply)
      + description            = "Managed by Terraform"
      + egress                 = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 0
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "-1"
              + security_groups  = []
              + self             = false
              + to_port          = 0
            },
        ]
      + id                     = (known after apply)
      + ingress                = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 80
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = []
              + self             = false
              + to_port          = 80
            },
        ]
      + name                   = "alb-security-group"
      + name_prefix            = (known after apply)
      + owner_id               = (known after apply)
      + region                 = "ap-south-1"
      + revoke_rules_on_delete = false
      + tags_all               = (known after apply)
      + vpc_id                 = (known after apply)
    }

  # aws_subnet.public[0] will be created
  + resource "aws_subnet" "public" {
      + arn                                            = (known after apply)
      + assign_ipv6_address_on_creation                = false
      + availability_zone                              = "ap-south-1a"
      + availability_zone_id                           = (known after apply)
      + cidr_block                                     = "10.0.0.0/24"
      + enable_dns64                                   = false
      + enable_resource_name_dns_a_record_on_launch    = false
      + enable_resource_name_dns_aaaa_record_on_launch = false
      + id                                             = (known after apply)
      + ipv6_cidr_block_association_id                 = (known after apply)
      + ipv6_native                                    = false
      + map_public_ip_on_launch                        = true
      + owner_id                                       = (known after apply)
      + private_dns_hostname_type_on_launch            = (known after apply)
      + region                                         = "ap-south-1"
      + tags                                           = {
          + "Name" = "public-subnet-0"
        }
      + tags_all                                       = {
          + "Name" = "public-subnet-0"
        }
      + vpc_id                                         = (known after apply)
    }

  # aws_subnet.public[1] will be created
  + resource "aws_subnet" "public" {
      + arn                                            = (known after apply)
      + assign_ipv6_address_on_creation                = false
      + availability_zone                              = "ap-south-1b"
      + availability_zone_id                           = (known after apply)
      + cidr_block                                     = "10.0.1.0/24"
      + enable_dns64                                   = false
      + enable_resource_name_dns_a_record_on_launch    = false
      + enable_resource_name_dns_aaaa_record_on_launch = false
      + id                                             = (known after apply)
      + ipv6_cidr_block_association_id                 = (known after apply)
      + ipv6_native                                    = false
      + map_public_ip_on_launch                        = true
      + owner_id                                       = (known after apply)
      + private_dns_hostname_type_on_launch            = (known after apply)
      + region                                         = "ap-south-1"
      + tags                                           = {
          + "Name" = "public-subnet-1"
        }
      + tags_all                                       = {
          + "Name" = "public-subnet-1"
        }
      + vpc_id                                         = (known after apply)
    }

  # aws_vpc.main will be created
  + resource "aws_vpc" "main" {
      + arn                                  = (known after apply)
      + cidr_block                           = "10.0.0.0/16"
      + default_network_acl_id               = (known after apply)
      + default_route_table_id               = (known after apply)
      + default_security_group_id            = (known after apply)
      + dhcp_options_id                      = (known after apply)
      + enable_dns_hostnames                 = true
      + enable_dns_support                   = true
      + enable_network_address_usage_metrics = (known after apply)
      + id                                   = (known after apply)
      + instance_tenancy                     = "default"
      + ipv6_association_id                  = (known after apply)
      + ipv6_cidr_block                      = (known after apply)
      + ipv6_cidr_block_network_border_group = (known after apply)
      + main_route_table_id                  = (known after apply)
      + owner_id                             = (known after apply)
      + region                               = "ap-south-1"
      + tags                                 = {
          + "Name" = "ecs-vpc"
        }
      + tags_all                             = {
          + "Name" = "ecs-vpc"
        }
    }

Plan: 16 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + alb_dns_name = (known after apply)
aws_iam_role.ecs_task_execution_role: Creating...
aws_ecs_cluster.main: Creating...
aws_vpc.main: Creating...
aws_iam_role.ecs_task_execution_role: Creation complete after 2s [id=ecsTaskExecutionRoleUnique]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Creating...
aws_ecs_task_definition.backend: Creating...
aws_ecs_task_definition.frontend: Creating...
aws_ecs_task_definition.backend: Creation complete after 0s [id=backend-task]
aws_ecs_task_definition.frontend: Creation complete after 0s [id=frontend-task]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Creation complete after 0s [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_vpc.main: Still creating... [11s elapsed]
aws_ecs_cluster.main: Still creating... [11s elapsed]
aws_ecs_cluster.main: Creation complete after 11s [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_vpc.main: Creation complete after 11s [id=vpc-0362005e6b6eb2070]
aws_subnet.public[0]: Creating...
aws_internet_gateway.gw: Creating...
aws_security_group.lb_sg: Creating...
aws_subnet.public[1]: Creating...
aws_lb_target_group.frontend_tg: Creating...
aws_internet_gateway.gw: Creation complete after 1s [id=igw-0eb905f2278b6d8b9]
aws_route.internet_access: Creating...
aws_lb_target_group.frontend_tg: Creation complete after 1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee]
aws_route.internet_access: Creation complete after 0s [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_security_group.lb_sg: Creation complete after 3s [id=sg-0ef95b7dc2b6e3ea3]
aws_subnet.public[0]: Still creating... [10s elapsed]
aws_subnet.public[1]: Still creating... [10s elapsed]
aws_subnet.public[1]: Creation complete after 11s [id=subnet-07e8a6c780dfa32fd]
aws_subnet.public[0]: Creation complete after 11s [id=subnet-0009d1bb301c6909e]
aws_lb.main: Creating...
aws_ecs_service.backend: Creating...
aws_ecs_service.frontend: Creating...
aws_ecs_service.backend: Creation complete after 1s [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
aws_ecs_service.frontend: Still creating... [10s elapsed]
aws_lb.main: Still creating... [10s elapsed]
aws_lb.main: Still creating... [20s elapsed]
aws_ecs_service.frontend: Still creating... [20s elapsed]
aws_lb.main: Still creating... [30s elapsed]
aws_ecs_service.frontend: Still creating... [30s elapsed]
aws_ecs_service.frontend: Still creating... [40s elapsed]
aws_lb.main: Still creating... [40s elapsed]
aws_lb.main: Still creating... [50s elapsed]
aws_ecs_service.frontend: Still creating... [50s elapsed]
aws_ecs_service.frontend: Still creating... [1m0s elapsed]
aws_lb.main: Still creating... [1m0s elapsed]
aws_lb.main: Still creating... [1m10s elapsed]
aws_ecs_service.frontend: Still creating... [1m10s elapsed]
aws_ecs_service.frontend: Still creating... [1m20s elapsed]
aws_lb.main: Still creating... [1m20s elapsed]
aws_ecs_service.frontend: Still creating... [1m30s elapsed]
aws_lb.main: Still creating... [1m30s elapsed]
aws_lb.main: Still creating... [1m40s elapsed]
aws_ecs_service.frontend: Still creating... [1m40s elapsed]
aws_lb.main: Still creating... [1m50s elapsed]
aws_ecs_service.frontend: Still creating... [1m50s elapsed]
aws_ecs_service.frontend: Still creating... [2m0s elapsed]
aws_lb.main: Still creating... [2m0s elapsed]
aws_lb.main: Still creating... [2m10s elapsed]
aws_ecs_service.frontend: Still creating... [2m10s elapsed]
aws_ecs_service.frontend: Still creating... [2m20s elapsed]
aws_lb.main: Still creating... [2m20s elapsed]
aws_lb.main: Still creating... [2m30s elapsed]
aws_ecs_service.frontend: Still creating... [2m30s elapsed]
aws_lb.main: Still creating... [2m40s elapsed]
aws_ecs_service.frontend: Still creating... [2m40s elapsed]
aws_lb.main: Still creating... [2m50s elapsed]
aws_ecs_service.frontend: Still creating... [2m50s elapsed]
aws_ecs_service.frontend: Still creating... [3m1s elapsed]
aws_lb.main: Still creating... [3m1s elapsed]
aws_lb.main: Creation complete after 3m3s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_lb_listener.http: Creating...
aws_lb_listener.http: Creation complete after 0s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/c76d4708f2376740/9afc0f6a3003b31c]
aws_ecs_service.frontend: Creation complete after 3m6s [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]

Apply complete! Resources: 16 added, 0 changed, 0 destroyed.                                                                                                                                                                                
                                                                                                                                                                                                                                            
Outputs:                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                            
alb_dns_name = "app-lb-1007430428.ap-south-1.elb.amazonaws.com"                                                                                                                                                                             
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ ls
alb.tf  backend  ecs.tf  frontend  main.tf  terraform.tfstate  terraform.tfstate.backup  terraform.tfvars  variables.tf
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ vim main.tf
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ vim al.tf  
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ vim alb.tf
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf apply -auto-approve
╷
│ Error: Reference to undeclared resource
│ 
│   on ecs.tf line 64, in resource "aws_ecs_task_definition" "frontend":
│   64:       { name = "BACKEND_URL", value = "http://${aws_lb.backend_lb.dns_name}:8000/people"} 
│ 
│ A managed resource "aws_lb" "backend_lb" has not been declared in the root module.
╵
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf apply -auto-approve
data.aws_availability_zones.available: Reading...
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
aws_ecs_cluster.main: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
aws_iam_role.ecs_task_execution_role: Refreshing state... [id=ecsTaskExecutionRoleUnique]
aws_vpc.main: Refreshing state... [id=vpc-0362005e6b6eb2070]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]
aws_subnet.public[1]: Refreshing state... [id=subnet-07e8a6c780dfa32fd]
aws_subnet.public[0]: Refreshing state... [id=subnet-0009d1bb301c6909e]
aws_security_group.lb_sg: Refreshing state... [id=sg-0ef95b7dc2b6e3ea3]
aws_internet_gateway.gw: Refreshing state... [id=igw-0eb905f2278b6d8b9]
aws_lb_target_group.frontend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee]
aws_route.internet_access: Refreshing state... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_lb.main: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_lb_listener.http: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/c76d4708f2376740/9afc0f6a3003b31c]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Refreshing state... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_ecs_task_definition.frontend: Refreshing state... [id=frontend-task]
aws_ecs_task_definition.backend: Refreshing state... [id=backend-task]
aws_ecs_service.frontend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_ecs_service.backend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  ~ update in-place
-/+ destroy and then create replacement

Terraform will perform the following actions:

  # aws_ecs_service.frontend will be updated in-place
  ~ resource "aws_ecs_service" "frontend" {
        id                                 = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service"
        name                               = "frontend-service"
        tags                               = {}
      ~ task_definition                    = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task:2" -> (known after apply)
        # (18 unchanged attributes hidden)

        # (5 unchanged blocks hidden)
    }

  # aws_ecs_task_definition.frontend must be replaced
-/+ resource "aws_ecs_task_definition" "frontend" {
      ~ arn                      = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task:2" -> (known after apply)
      ~ arn_without_revision     = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task" -> (known after apply)
      ~ container_definitions    = jsonencode(
          ~ [
              ~ {
                  ~ environment    = [
                      ~ {
                            name  = "BACKEND_URL"
                          ~ value = "http://localhost:8000/people" -> "http://app-lb-1007430428.ap-south-1.elb.amazonaws.com:8000/people"
                        },
                    ]
                  - essential      = true
                  - mountPoints    = []
                    name           = "frontend"
                  ~ portMappings   = [
                      ~ {
                          - protocol      = "tcp"
                            # (2 unchanged attributes hidden)
                        },
                    ]
                  - systemControls = []
                  - volumesFrom    = []
                    # (1 unchanged attribute hidden)
                },
            ] # forces replacement
        )
      ~ enable_fault_injection   = false -> (known after apply)
      ~ id                       = "frontend-task" -> (known after apply)
      ~ revision                 = 2 -> (known after apply)
      - tags                     = {} -> null
      ~ tags_all                 = {} -> (known after apply)
        # (9 unchanged attributes hidden)
    }

Plan: 1 to add, 1 to change, 1 to destroy.
aws_ecs_task_definition.frontend: Destroying... [id=frontend-task]
aws_ecs_task_definition.frontend: Destruction complete after 0s
aws_ecs_task_definition.frontend: Creating...
aws_ecs_task_definition.frontend: Creation complete after 0s [id=frontend-task]
aws_ecs_service.frontend: Modifying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_ecs_service.frontend: Modifications complete after 1s [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]

Apply complete! Resources: 1 added, 1 changed, 1 destroyed.                                                                                                                                                                                 
                                                                                                                                                                                                                                            
Outputs:                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                            
alb_dns_name = "app-lb-1007430428.ap-south-1.elb.amazonaws.com"                                                                                                                                                                             
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf apply -auto-approve
aws_vpc.main: Refreshing state... [id=vpc-0362005e6b6eb2070]
data.aws_availability_zones.available: Reading...
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
aws_ecs_cluster.main: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
aws_iam_role.ecs_task_execution_role: Refreshing state... [id=ecsTaskExecutionRoleUnique]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]
aws_internet_gateway.gw: Refreshing state... [id=igw-0eb905f2278b6d8b9]
aws_security_group.lb_sg: Refreshing state... [id=sg-0ef95b7dc2b6e3ea3]
aws_lb_target_group.frontend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee]
aws_subnet.public[0]: Refreshing state... [id=subnet-0009d1bb301c6909e]
aws_subnet.public[1]: Refreshing state... [id=subnet-07e8a6c780dfa32fd]
aws_route.internet_access: Refreshing state... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_lb.main: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_lb_listener.http: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/c76d4708f2376740/9afc0f6a3003b31c]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Refreshing state... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_ecs_task_definition.frontend: Refreshing state... [id=frontend-task]
aws_ecs_task_definition.backend: Refreshing state... [id=backend-task]
aws_ecs_service.backend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
aws_ecs_service.frontend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create
  ~ update in-place
-/+ destroy and then create replacement

Terraform will perform the following actions:

  # aws_cloudwatch_log_group.backend will be created
  + resource "aws_cloudwatch_log_group" "backend" {
      + arn                         = (known after apply)
      + deletion_protection_enabled = (known after apply)
      + id                          = (known after apply)
      + log_group_class             = (known after apply)
      + name                        = "/ecs/backend-task"
      + name_prefix                 = (known after apply)
      + region                      = "ap-south-1"
      + retention_in_days           = 7
      + skip_destroy                = false
      + tags_all                    = (known after apply)
    }

  # aws_cloudwatch_log_group.frontend will be created
  + resource "aws_cloudwatch_log_group" "frontend" {
      + arn                         = (known after apply)
      + deletion_protection_enabled = (known after apply)
      + id                          = (known after apply)
      + log_group_class             = (known after apply)
      + name                        = "/ecs/frontend-task"
      + name_prefix                 = (known after apply)
      + region                      = "ap-south-1"
      + retention_in_days           = 7
      + skip_destroy                = false
      + tags_all                    = (known after apply)
    }

  # aws_ecs_service.backend will be updated in-place
  ~ resource "aws_ecs_service" "backend" {
        id                                 = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service"
        name                               = "backend-service"
        tags                               = {}
      ~ task_definition                    = "arn:aws:ecs:ap-south-1:107634107029:task-definition/backend-task:2" -> (known after apply)
        # (18 unchanged attributes hidden)

        # (4 unchanged blocks hidden)
    }

  # aws_ecs_service.frontend will be updated in-place
  ~ resource "aws_ecs_service" "frontend" {
        id                                 = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service"
        name                               = "frontend-service"
        tags                               = {}
      ~ task_definition                    = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task:3" -> (known after apply)
        # (18 unchanged attributes hidden)

        # (5 unchanged blocks hidden)
    }

  # aws_ecs_task_definition.backend must be replaced
-/+ resource "aws_ecs_task_definition" "backend" {
      ~ arn                      = "arn:aws:ecs:ap-south-1:107634107029:task-definition/backend-task:2" -> (known after apply)
      ~ arn_without_revision     = "arn:aws:ecs:ap-south-1:107634107029:task-definition/backend-task" -> (known after apply)
      ~ container_definitions    = jsonencode(
          ~ [
              ~ {
                  - environment      = []
                  - essential        = true
                  + logConfiguration = {
                      + logDriver = "awslogs"
                      + options   = {
                          + awslogs-group         = "/ecs/backend-task"
                          + awslogs-region        = "ap-south-1"
                          + awslogs-stream-prefix = "ecs"
                        }
                    }
                  - mountPoints      = []
                    name             = "backend"
                  ~ portMappings     = [
                      ~ {
                          - protocol      = "tcp"
                            # (2 unchanged attributes hidden)
                        },
                    ]
                  - systemControls   = []
                  - volumesFrom      = []
                    # (1 unchanged attribute hidden)
                },
            ] # forces replacement
        )
      ~ enable_fault_injection   = false -> (known after apply)
      ~ id                       = "backend-task" -> (known after apply)
      ~ revision                 = 2 -> (known after apply)
      - tags                     = {} -> null
      ~ tags_all                 = {} -> (known after apply)
        # (9 unchanged attributes hidden)
    }

  # aws_ecs_task_definition.frontend must be replaced
-/+ resource "aws_ecs_task_definition" "frontend" {
      ~ arn                      = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task:3" -> (known after apply)
      ~ arn_without_revision     = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task" -> (known after apply)
      ~ container_definitions    = jsonencode(
          ~ [
              ~ {
                  - essential        = true
                  + logConfiguration = {
                      + logDriver = "awslogs"
                      + options   = {
                          + awslogs-group         = "/ecs/frontend-task"
                          + awslogs-region        = "ap-south-1"
                          + awslogs-stream-prefix = "ecs"
                        }
                    }
                  - mountPoints      = []
                    name             = "frontend"
                  ~ portMappings     = [
                      ~ {
                          - protocol      = "tcp"
                            # (2 unchanged attributes hidden)
                        },
                    ]
                  - systemControls   = []
                  - volumesFrom      = []
                    # (2 unchanged attributes hidden)
                },
            ] # forces replacement
        )
      ~ enable_fault_injection   = false -> (known after apply)
      ~ id                       = "frontend-task" -> (known after apply)
      ~ revision                 = 3 -> (known after apply)
      - tags                     = {} -> null
      ~ tags_all                 = {} -> (known after apply)
        # (9 unchanged attributes hidden)
    }

  # aws_lb.main will be updated in-place
  ~ resource "aws_lb" "main" {
        id                                          = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740"
      ~ idle_timeout                                = 120 -> 60
        name                                        = "app-lb"
        tags                                        = {}
        # (24 unchanged attributes hidden)

        # (5 unchanged blocks hidden)
    }

  # aws_security_group.lb_sg will be updated in-place
  ~ resource "aws_security_group" "lb_sg" {
        id                     = "sg-0ef95b7dc2b6e3ea3"
      ~ ingress                = [
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - description      = ""
              - from_port        = 8000
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "tcp"
              - security_groups  = []
              - self             = false
              - to_port          = 8000
            },
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 80
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = []
              + self             = false
              + to_port          = 80
            },
        ]
        name                   = "alb-security-group"
        tags                   = {}
        # (8 unchanged attributes hidden)
    }

Plan: 4 to add, 4 to change, 2 to destroy.
aws_ecs_task_definition.backend: Destroying... [id=backend-task]
aws_ecs_task_definition.frontend: Destroying... [id=frontend-task]
aws_ecs_task_definition.backend: Destruction complete after 0s
aws_ecs_task_definition.frontend: Destruction complete after 0s
aws_cloudwatch_log_group.backend: Creating...
aws_cloudwatch_log_group.frontend: Creating...
aws_security_group.lb_sg: Modifying... [id=sg-0ef95b7dc2b6e3ea3]
aws_cloudwatch_log_group.frontend: Creation complete after 0s [id=/ecs/frontend-task]
aws_cloudwatch_log_group.backend: Creation complete after 0s [id=/ecs/backend-task]
aws_ecs_task_definition.backend: Creating...
aws_ecs_task_definition.backend: Creation complete after 0s [id=backend-task]
aws_security_group.lb_sg: Modifications complete after 1s [id=sg-0ef95b7dc2b6e3ea3]
aws_lb.main: Modifying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_ecs_service.backend: Modifying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
aws_ecs_service.backend: Modifications complete after 0s [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
aws_lb.main: Still modifying... [id=arn:aws:elasticloadbalancing:ap-south-1...adbalancer/app/app-lb/c76d4708f2376740, 10s elapsed]
aws_lb.main: Still modifying... [id=arn:aws:elasticloadbalancing:ap-south-1...adbalancer/app/app-lb/c76d4708f2376740, 20s elapsed]
aws_lb.main: Still modifying... [id=arn:aws:elasticloadbalancing:ap-south-1...adbalancer/app/app-lb/c76d4708f2376740, 30s elapsed]
aws_lb.main: Modifications complete after 30s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_ecs_task_definition.frontend: Creating...
aws_ecs_task_definition.frontend: Creation complete after 1s [id=frontend-task]
aws_ecs_service.frontend: Modifying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_ecs_service.frontend: Modifications complete after 1s [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]

Apply complete! Resources: 4 added, 4 changed, 2 destroyed.                                                                                                                                                                                 
                                                                                                                                                                                                                                            
Outputs:                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                            
alb_dns_name = "app-lb-1007430428.ap-south-1.elb.amazonaws.com"                                                                                                                                                                             
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ 
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ vim alb.tf 
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf init               

Initializing the backend...

Initializing provider plugins...
- Reusing previous version of hashicorp/aws from the dependency lock file
- Using previously-installed hashicorp/aws v6.28.0

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf apply -auto-approve
aws_cloudwatch_log_group.backend: Refreshing state... [id=/ecs/backend-task]
data.aws_availability_zones.available: Reading...
aws_iam_role.ecs_task_execution_role: Refreshing state... [id=ecsTaskExecutionRoleUnique]
aws_ecs_cluster.main: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_lb_listener.http: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/c76d4708f2376740/9afc0f6a3003b31c]
aws_cloudwatch_log_group.frontend: Refreshing state... [id=/ecs/frontend-task]
aws_vpc.main: Refreshing state... [id=vpc-0362005e6b6eb2070]
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]
aws_internet_gateway.gw: Refreshing state... [id=igw-0eb905f2278b6d8b9]
aws_security_group.lb_sg: Refreshing state... [id=sg-0ef95b7dc2b6e3ea3]
aws_subnet.public[1]: Refreshing state... [id=subnet-07e8a6c780dfa32fd]
aws_subnet.public[0]: Refreshing state... [id=subnet-0009d1bb301c6909e]
aws_lb_target_group.frontend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee]
aws_route.internet_access: Refreshing state... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_lb.main: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Refreshing state... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_ecs_task_definition.frontend: Refreshing state... [id=frontend-task]
aws_ecs_task_definition.backend: Refreshing state... [id=backend-task]
aws_ecs_service.frontend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_ecs_service.backend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create
  ~ update in-place
  - destroy
-/+ destroy and then create replacement

Terraform will perform the following actions:

  # aws_ecs_service.backend will be updated in-place
  ~ resource "aws_ecs_service" "backend" {
      ~ health_check_grace_period_seconds  = 0 -> 180
        id                                 = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service"
        name                               = "backend-service"
        tags                               = {}
        # (18 unchanged attributes hidden)

      + load_balancer {
          + container_name   = "backend"
          + container_port   = 8000
          + target_group_arn = (known after apply)
        }

      ~ network_configuration {
          ~ security_groups  = [
              - "sg-0ef95b7dc2b6e3ea3",
            ] -> (known after apply)
            # (2 unchanged attributes hidden)
        }

        # (3 unchanged blocks hidden)
    }

  # aws_ecs_service.frontend will be updated in-place
  ~ resource "aws_ecs_service" "frontend" {
      ~ health_check_grace_period_seconds  = 0 -> 180
        id                                 = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service"
        name                               = "frontend-service"
        tags                               = {}
        # (18 unchanged attributes hidden)

      - load_balancer {
          - container_name   = "frontend" -> null
          - container_port   = 3000 -> null
          - target_group_arn = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee" -> null
        }
      + load_balancer {
          + container_name   = "frontend"
          + container_port   = 3000
          + target_group_arn = (known after apply)
        }

      ~ network_configuration {
          ~ security_groups  = [
              - "sg-0ef95b7dc2b6e3ea3",
            ] -> (known after apply)
            # (2 unchanged attributes hidden)
        }

        # (3 unchanged blocks hidden)
    }

  # aws_lb.main will be updated in-place
  ~ resource "aws_lb" "main" {
        id                                          = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740"
        name                                        = "app-lb"
      ~ security_groups                             = [
          - "sg-0ef95b7dc2b6e3ea3",
        ] -> (known after apply)
        tags                                        = {}
        # (24 unchanged attributes hidden)

        # (5 unchanged blocks hidden)
    }

  # aws_lb_listener.backend_http will be created
  + resource "aws_lb_listener" "backend_http" {
      + arn                                                                   = (known after apply)
      + id                                                                    = (known after apply)
      + load_balancer_arn                                                     = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740"
      + port                                                                  = 8000
      + protocol                                                              = "HTTP"
      + region                                                                = "ap-south-1"
      + routing_http_request_x_amzn_mtls_clientcert_header_name               = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_issuer_header_name        = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_leaf_header_name          = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_subject_header_name       = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_validity_header_name      = (known after apply)
      + routing_http_request_x_amzn_tls_cipher_suite_header_name              = (known after apply)
      + routing_http_request_x_amzn_tls_version_header_name                   = (known after apply)
      + routing_http_response_access_control_allow_credentials_header_value   = (known after apply)
      + routing_http_response_access_control_allow_headers_header_value       = (known after apply)
      + routing_http_response_access_control_allow_methods_header_value       = (known after apply)
      + routing_http_response_access_control_allow_origin_header_value        = (known after apply)
      + routing_http_response_access_control_expose_headers_header_value      = (known after apply)
      + routing_http_response_access_control_max_age_header_value             = (known after apply)
      + routing_http_response_content_security_policy_header_value            = (known after apply)
      + routing_http_response_server_enabled                                  = (known after apply)
      + routing_http_response_strict_transport_security_header_value          = (known after apply)
      + routing_http_response_x_content_type_options_header_value             = (known after apply)
      + routing_http_response_x_frame_options_header_value                    = (known after apply)
      + ssl_policy                                                            = (known after apply)
      + tags_all                                                              = (known after apply)
      + tcp_idle_timeout_seconds                                              = (known after apply)

      + default_action {
          + order            = (known after apply)
          + target_group_arn = (known after apply)
          + type             = "forward"
        }
    }

  # aws_lb_listener.frontend_http will be created
  + resource "aws_lb_listener" "frontend_http" {
      + arn                                                                   = (known after apply)
      + id                                                                    = (known after apply)
      + load_balancer_arn                                                     = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740"
      + port                                                                  = 80
      + protocol                                                              = "HTTP"
      + region                                                                = "ap-south-1"
      + routing_http_request_x_amzn_mtls_clientcert_header_name               = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_issuer_header_name        = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_leaf_header_name          = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_subject_header_name       = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_validity_header_name      = (known after apply)
      + routing_http_request_x_amzn_tls_cipher_suite_header_name              = (known after apply)
      + routing_http_request_x_amzn_tls_version_header_name                   = (known after apply)
      + routing_http_response_access_control_allow_credentials_header_value   = (known after apply)
      + routing_http_response_access_control_allow_headers_header_value       = (known after apply)
      + routing_http_response_access_control_allow_methods_header_value       = (known after apply)
      + routing_http_response_access_control_allow_origin_header_value        = (known after apply)
      + routing_http_response_access_control_expose_headers_header_value      = (known after apply)
      + routing_http_response_access_control_max_age_header_value             = (known after apply)
      + routing_http_response_content_security_policy_header_value            = (known after apply)
      + routing_http_response_server_enabled                                  = (known after apply)
      + routing_http_response_strict_transport_security_header_value          = (known after apply)
      + routing_http_response_x_content_type_options_header_value             = (known after apply)
      + routing_http_response_x_frame_options_header_value                    = (known after apply)
      + ssl_policy                                                            = (known after apply)
      + tags_all                                                              = (known after apply)
      + tcp_idle_timeout_seconds                                              = (known after apply)

      + default_action {
          + order            = (known after apply)
          + target_group_arn = (known after apply)
          + type             = "forward"
        }
    }

  # aws_lb_listener.http will be destroyed
  # (because aws_lb_listener.http is not in configuration)
  - resource "aws_lb_listener" "http" {
      - arn                                  = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/c76d4708f2376740/9afc0f6a3003b31c" -> null
      - id                                   = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/c76d4708f2376740/9afc0f6a3003b31c" -> null
      - load_balancer_arn                    = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740" -> null
      - port                                 = 80 -> null
      - protocol                             = "HTTP" -> null
      - region                               = "ap-south-1" -> null
      - routing_http_response_server_enabled = true -> null
      - tags                                 = {} -> null
      - tags_all                             = {} -> null

      - default_action {
          - order            = 1 -> null
          - target_group_arn = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee" -> null
          - type             = "forward" -> null
        }
    }

  # aws_lb_target_group.backend_tg will be created
  + resource "aws_lb_target_group" "backend_tg" {
      + arn                                = (known after apply)
      + arn_suffix                         = (known after apply)
      + connection_termination             = (known after apply)
      + deregistration_delay               = "300"
      + id                                 = (known after apply)
      + ip_address_type                    = (known after apply)
      + lambda_multi_value_headers_enabled = false
      + load_balancer_arns                 = (known after apply)
      + load_balancing_algorithm_type      = (known after apply)
      + load_balancing_anomaly_mitigation  = (known after apply)
      + load_balancing_cross_zone_enabled  = (known after apply)
      + name                               = "backend-tg"
      + name_prefix                        = (known after apply)
      + port                               = 8000
      + preserve_client_ip                 = (known after apply)
      + protocol                           = "HTTP"
      + protocol_version                   = (known after apply)
      + proxy_protocol_v2                  = false
      + region                             = "ap-south-1"
      + slow_start                         = 0
      + tags_all                           = (known after apply)
      + target_type                        = "ip"
      + vpc_id                             = "vpc-0362005e6b6eb2070"

      + health_check {
          + enabled             = true
          + healthy_threshold   = 2
          + interval            = 30
          + matcher             = "200"
          + path                = "/health"
          + port                = "8000"
          + protocol            = "HTTP"
          + timeout             = 10
          + unhealthy_threshold = 3
        }
    }

  # aws_lb_target_group.frontend_tg must be replaced
-/+ resource "aws_lb_target_group" "frontend_tg" {
      ~ arn                                = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee" -> (known after apply)
      ~ arn_suffix                         = "targetgroup/frontend-target-group/d0c0357c5b9104ee" -> (known after apply)
      + connection_termination             = (known after apply)
      ~ id                                 = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee" -> (known after apply)
      ~ ip_address_type                    = "ipv4" -> (known after apply)
      ~ load_balancer_arns                 = [
          - "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740",
        ] -> (known after apply)
      ~ load_balancing_algorithm_type      = "round_robin" -> (known after apply)
      ~ load_balancing_anomaly_mitigation  = "off" -> (known after apply)
      ~ load_balancing_cross_zone_enabled  = "use_load_balancer_configuration" -> (known after apply)
      ~ name                               = "frontend-target-group" -> "frontend-tg" # forces replacement
      + name_prefix                        = (known after apply)
      + preserve_client_ip                 = (known after apply)
      ~ protocol_version                   = "HTTP1" -> (known after apply)
      - tags                               = {} -> null
      ~ tags_all                           = {} -> (known after apply)
      - target_control_port                = 0 -> null
        # (9 unchanged attributes hidden)

      ~ health_check {
          ~ healthy_threshold   = 3 -> 2
          ~ timeout             = 5 -> 10
            # (7 unchanged attributes hidden)
        }

      - stickiness {
          - cookie_duration = 86400 -> null
          - enabled         = false -> null
          - type            = "lb_cookie" -> null
        }

      - target_failover {}

      - target_group_health {
          - dns_failover {
              - minimum_healthy_targets_count      = "1" -> null
              - minimum_healthy_targets_percentage = "off" -> null
            }
          - unhealthy_state_routing {
              - minimum_healthy_targets_count      = 1 -> null
              - minimum_healthy_targets_percentage = "off" -> null
            }
        }

      - target_health_state {}
    }

  # aws_security_group.ecs_task_sg will be created
  + resource "aws_security_group" "ecs_task_sg" {
      + arn                    = (known after apply)
      + description            = "Allow traffic only from ALB"
      + egress                 = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 0
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "-1"
              + security_groups  = []
              + self             = false
              + to_port          = 0
            },
        ]
      + id                     = (known after apply)
      + ingress                = [
          + {
              + cidr_blocks      = []
              + description      = ""
              + from_port        = 3000
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = (known after apply)
              + self             = false
              + to_port          = 3000
            },
          + {
              + cidr_blocks      = []
              + description      = ""
              + from_port        = 8000
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = (known after apply)
              + self             = false
              + to_port          = 8000
            },
        ]
      + name                   = "ecs-task-security-group"
      + name_prefix            = (known after apply)
      + owner_id               = (known after apply)
      + region                 = "ap-south-1"
      + revoke_rules_on_delete = false
      + tags_all               = (known after apply)
      + vpc_id                 = "vpc-0362005e6b6eb2070"
    }

  # aws_security_group.lb_sg must be replaced
-/+ resource "aws_security_group" "lb_sg" {
      ~ arn                    = "arn:aws:ec2:ap-south-1:107634107029:security-group/sg-0ef95b7dc2b6e3ea3" -> (known after apply)
      ~ description            = "Managed by Terraform" -> "Controls access to the ALB" # forces replacement
      ~ id                     = "sg-0ef95b7dc2b6e3ea3" -> (known after apply)
      ~ ingress                = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 8000
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = []
              + self             = false
              + to_port          = 8000
            },
            # (1 unchanged element hidden)
        ]
        name                   = "alb-security-group"
      + name_prefix            = (known after apply)
      ~ owner_id               = "107634107029" -> (known after apply)
      - tags                   = {} -> null
      ~ tags_all               = {} -> (known after apply)
        # (4 unchanged attributes hidden)
    }

Plan: 6 to add, 3 to change, 3 to destroy.
aws_lb_listener.http: Destroying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/c76d4708f2376740/9afc0f6a3003b31c]
aws_lb_target_group.backend_tg: Creating...
aws_lb_listener.http: Destruction complete after 0s
aws_security_group.lb_sg: Destroying... [id=sg-0ef95b7dc2b6e3ea3]
aws_lb_target_group.frontend_tg: Destroying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-target-group/d0c0357c5b9104ee]
aws_lb_target_group.frontend_tg: Destruction complete after 0s
aws_lb_target_group.frontend_tg: Creating...
aws_lb_target_group.backend_tg: Creation complete after 1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/65be13124060a7ef]
aws_lb_target_group.frontend_tg: Creation complete after 1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/10e21759b50e87b2]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 10s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 20s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 30s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 40s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 50s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 1m0s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 1m10s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 1m20s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 1m31s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 1m41s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 1m51s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 2m1s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 2m11s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 2m21s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 2m31s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 2m41s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 2m51s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 3m1s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 3m11s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 3m21s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 3m31s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 3m41s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 3m51s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 4m1s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 4m11s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 4m21s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 4m31s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 4m41s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 4m51s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 5m1s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 5m11s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 5m21s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 5m32s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 5m42s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 5m52s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 6m2s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 6m12s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 6m22s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 6m32s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 6m42s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 6m52s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 7m2s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 7m12s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 7m22s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 7m32s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 7m42s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 7m52s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 8m2s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 8m12s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 8m22s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 8m32s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 8m42s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 8m52s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 9m2s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 9m12s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 9m22s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 9m32s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 9m42s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 9m52s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 10m2s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 10m12s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 10m22s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 10m32s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 10m42s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 10m52s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 11m2s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 11m12s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 11m23s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 11m33s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 11m43s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 11m53s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 12m3s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 12m13s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 12m23s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 12m33s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 12m43s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 12m53s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 13m3s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 13m13s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 13m23s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 13m33s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 13m43s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 13m53s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 14m3s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 14m13s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 14m23s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 14m33s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 14m43s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 14m53s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 15m3s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 15m13s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 15m23s elapsed]
aws_security_group.lb_sg: Still destroying... [id=sg-0ef95b7dc2b6e3ea3, 15m33s elapsed]
╷
│ Error: deleting Security Group (sg-0ef95b7dc2b6e3ea3): operation error EC2: DeleteSecurityGroup, https response error StatusCode: 400, RequestID: 3613e7c5-847a-49c9-86ef-66bbb9551dbd, api error DependencyViolation: resource sg-0ef95b7dc2b6e3ea3 has a dependent object
│ 
│ 
╵
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf refresh            
data.aws_availability_zones.available: Reading...
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
aws_ecs_cluster.main: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_cloudwatch_log_group.backend: Refreshing state... [id=/ecs/backend-task]
aws_iam_role.ecs_task_execution_role: Refreshing state... [id=ecsTaskExecutionRoleUnique]
aws_vpc.main: Refreshing state... [id=vpc-0362005e6b6eb2070]
aws_cloudwatch_log_group.frontend: Refreshing state... [id=/ecs/frontend-task]
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]
aws_security_group.lb_sg: Refreshing state... [id=sg-0ef95b7dc2b6e3ea3]
aws_subnet.public[0]: Refreshing state... [id=subnet-0009d1bb301c6909e]
aws_subnet.public[1]: Refreshing state... [id=subnet-07e8a6c780dfa32fd]
aws_lb_target_group.frontend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/10e21759b50e87b2]
aws_lb_target_group.backend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/65be13124060a7ef]
aws_internet_gateway.gw: Refreshing state... [id=igw-0eb905f2278b6d8b9]
aws_route.internet_access: Refreshing state... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_lb.main: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Refreshing state... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_ecs_task_definition.frontend: Refreshing state... [id=frontend-task]
aws_ecs_task_definition.backend: Refreshing state... [id=backend-task]
aws_ecs_service.frontend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_ecs_service.backend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
^CStopping operation...

Interrupt received.
Please wait for Terraform to exit or data loss may occur.
Gracefully shutting down...

╷
│ Error: execution halted
│ 
│ 
╵
╷
│ Error: execution halted
│ 
│ 
╵
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf apply -auto-approve
data.aws_availability_zones.available: Reading...
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
aws_iam_role.ecs_task_execution_role: Refreshing state... [id=ecsTaskExecutionRoleUnique]
aws_ecs_cluster.main: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
aws_vpc.main: Refreshing state... [id=vpc-0362005e6b6eb2070]
aws_cloudwatch_log_group.frontend: Refreshing state... [id=/ecs/frontend-task]
aws_cloudwatch_log_group.backend: Refreshing state... [id=/ecs/backend-task]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]
aws_security_group.lb_sg: Refreshing state... [id=sg-0ef95b7dc2b6e3ea3]
aws_lb_target_group.backend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/65be13124060a7ef]
aws_internet_gateway.gw: Refreshing state... [id=igw-0eb905f2278b6d8b9]
aws_subnet.public[0]: Refreshing state... [id=subnet-0009d1bb301c6909e]
aws_lb_target_group.frontend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/10e21759b50e87b2]
aws_subnet.public[1]: Refreshing state... [id=subnet-07e8a6c780dfa32fd]
aws_route.internet_access: Refreshing state... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_lb.main: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Refreshing state... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_ecs_task_definition.frontend: Refreshing state... [id=frontend-task]
aws_ecs_task_definition.backend: Refreshing state... [id=backend-task]
aws_ecs_service.backend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
aws_ecs_service.frontend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]

Note: Objects have changed outside of Terraform

Terraform detected the following changes made outside of Terraform since the last "terraform apply" which may have affected this plan:

  # aws_lb.main has been deleted
  - resource "aws_lb" "main" {
      - arn                                         = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740" -> null
      - dns_name                                    = "app-lb-1007430428.ap-south-1.elb.amazonaws.com" -> null
        id                                          = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/c76d4708f2376740"
        name                                        = "app-lb"
        tags                                        = {}
        # (23 unchanged attributes hidden)

        # (5 unchanged blocks hidden)
    }

  # aws_lb_target_group.backend_tg has been deleted
  - resource "aws_lb_target_group" "backend_tg" {
      - arn                                = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/65be13124060a7ef" -> null
        id                                 = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/65be13124060a7ef"
        name                               = "backend-tg"
        # (18 unchanged attributes hidden)

        # (5 unchanged blocks hidden)
    }

  # aws_lb_target_group.frontend_tg has been deleted
  - resource "aws_lb_target_group" "frontend_tg" {
      - arn                                = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/10e21759b50e87b2" -> null
        id                                 = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/10e21759b50e87b2"
        name                               = "frontend-tg"
        # (18 unchanged attributes hidden)

        # (5 unchanged blocks hidden)
    }

  # aws_security_group.lb_sg has been deleted
  - resource "aws_security_group" "lb_sg" {
      - id                     = "sg-0ef95b7dc2b6e3ea3" -> null
        name                   = "alb-security-group"
        tags                   = {}
        # (9 unchanged attributes hidden)
    }


Unless you have made equivalent changes to your configuration, or ignored the relevant attributes using ignore_changes, the following plan may include actions to undo or respond to these changes.

─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create
-/+ destroy and then create replacement

Terraform will perform the following actions:

  # aws_ecs_service.backend will be created
  + resource "aws_ecs_service" "backend" {
      + arn                                = (known after apply)
      + availability_zone_rebalancing      = (known after apply)
      + cluster                            = "arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster"
      + deployment_maximum_percent         = 200
      + deployment_minimum_healthy_percent = 100
      + desired_count                      = 1
      + enable_ecs_managed_tags            = false
      + enable_execute_command             = false
      + health_check_grace_period_seconds  = 180
      + iam_role                           = (known after apply)
      + id                                 = (known after apply)
      + launch_type                        = "FARGATE"
      + name                               = "backend-service"
      + platform_version                   = (known after apply)
      + region                             = "ap-south-1"
      + scheduling_strategy                = "REPLICA"
      + tags_all                           = (known after apply)
      + task_definition                    = "arn:aws:ecs:ap-south-1:107634107029:task-definition/backend-task:3"
      + triggers                           = (known after apply)
      + wait_for_steady_state              = false

      + load_balancer {
          + container_name   = "backend"
          + container_port   = 8000
          + target_group_arn = (known after apply)
        }

      + network_configuration {
          + assign_public_ip = true
          + security_groups  = (known after apply)
          + subnets          = [
              + "subnet-0009d1bb301c6909e",
              + "subnet-07e8a6c780dfa32fd",
            ]
        }
    }

  # aws_ecs_service.frontend will be created
  + resource "aws_ecs_service" "frontend" {
      + arn                                = (known after apply)
      + availability_zone_rebalancing      = (known after apply)
      + cluster                            = "arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster"
      + deployment_maximum_percent         = 200
      + deployment_minimum_healthy_percent = 100
      + desired_count                      = 1
      + enable_ecs_managed_tags            = false
      + enable_execute_command             = false
      + health_check_grace_period_seconds  = 180
      + iam_role                           = (known after apply)
      + id                                 = (known after apply)
      + launch_type                        = "FARGATE"
      + name                               = "frontend-service"
      + platform_version                   = (known after apply)
      + region                             = "ap-south-1"
      + scheduling_strategy                = "REPLICA"
      + tags_all                           = (known after apply)
      + task_definition                    = (known after apply)
      + triggers                           = (known after apply)
      + wait_for_steady_state              = false

      + load_balancer {
          + container_name   = "frontend"
          + container_port   = 3000
          + target_group_arn = (known after apply)
        }

      + network_configuration {
          + assign_public_ip = true
          + security_groups  = (known after apply)
          + subnets          = [
              + "subnet-0009d1bb301c6909e",
              + "subnet-07e8a6c780dfa32fd",
            ]
        }
    }

  # aws_ecs_task_definition.frontend must be replaced
-/+ resource "aws_ecs_task_definition" "frontend" {
      ~ arn                      = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task:4" -> (known after apply)
      ~ arn_without_revision     = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task" -> (known after apply)
      ~ container_definitions    = jsonencode(
            [
              - {
                  - environment      = [
                      - {
                          - name  = "BACKEND_URL"
                          - value = "http://app-lb-1007430428.ap-south-1.elb.amazonaws.com:8000/people"
                        },
                    ]
                  - essential        = true
                  - image            = "107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend"
                  - logConfiguration = {
                      - logDriver = "awslogs"
                      - options   = {
                          - awslogs-group         = "/ecs/frontend-task"
                          - awslogs-region        = "ap-south-1"
                          - awslogs-stream-prefix = "ecs"
                        }
                    }
                  - mountPoints      = []
                  - name             = "frontend"
                  - portMappings     = [
                      - {
                          - containerPort = 3000
                          - hostPort      = 3000
                          - protocol      = "tcp"
                        },
                    ]
                  - systemControls   = []
                  - volumesFrom      = []
                },
            ] # forces replacement
        ) -> (known after apply) # forces replacement
      ~ enable_fault_injection   = false -> (known after apply)
      ~ id                       = "frontend-task" -> (known after apply)
      ~ revision                 = 4 -> (known after apply)
      - tags                     = {} -> null
      ~ tags_all                 = {} -> (known after apply)
        # (9 unchanged attributes hidden)
    }

  # aws_lb.main will be created
  + resource "aws_lb" "main" {
      + arn                                                          = (known after apply)
      + arn_suffix                                                   = (known after apply)
      + client_keep_alive                                            = 3600
      + desync_mitigation_mode                                       = "defensive"
      + dns_name                                                     = (known after apply)
      + drop_invalid_header_fields                                   = false
      + enable_deletion_protection                                   = false
      + enable_http2                                                 = true
      + enable_tls_version_and_cipher_suite_headers                  = false
      + enable_waf_fail_open                                         = false
      + enable_xff_client_port                                       = false
      + enable_zonal_shift                                           = false
      + enforce_security_group_inbound_rules_on_private_link_traffic = (known after apply)
      + id                                                           = (known after apply)
      + idle_timeout                                                 = 60
      + internal                                                     = (known after apply)
      + ip_address_type                                              = (known after apply)
      + load_balancer_type                                           = "application"
      + name                                                         = "app-lb"
      + name_prefix                                                  = (known after apply)
      + preserve_host_header                                         = false
      + region                                                       = "ap-south-1"
      + secondary_ips_auto_assigned_per_subnet                       = (known after apply)
      + security_groups                                              = (known after apply)
      + subnets                                                      = [
          + "subnet-0009d1bb301c6909e",
          + "subnet-07e8a6c780dfa32fd",
        ]
      + tags_all                                                     = (known after apply)
      + vpc_id                                                       = (known after apply)
      + xff_header_processing_mode                                   = "append"
      + zone_id                                                      = (known after apply)
    }

  # aws_lb_listener.backend_http will be created
  + resource "aws_lb_listener" "backend_http" {
      + arn                                                                   = (known after apply)
      + id                                                                    = (known after apply)
      + load_balancer_arn                                                     = (known after apply)
      + port                                                                  = 8000
      + protocol                                                              = "HTTP"
      + region                                                                = "ap-south-1"
      + routing_http_request_x_amzn_mtls_clientcert_header_name               = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_issuer_header_name        = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_leaf_header_name          = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_subject_header_name       = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_validity_header_name      = (known after apply)
      + routing_http_request_x_amzn_tls_cipher_suite_header_name              = (known after apply)
      + routing_http_request_x_amzn_tls_version_header_name                   = (known after apply)
      + routing_http_response_access_control_allow_credentials_header_value   = (known after apply)
      + routing_http_response_access_control_allow_headers_header_value       = (known after apply)
      + routing_http_response_access_control_allow_methods_header_value       = (known after apply)
      + routing_http_response_access_control_allow_origin_header_value        = (known after apply)
      + routing_http_response_access_control_expose_headers_header_value      = (known after apply)
      + routing_http_response_access_control_max_age_header_value             = (known after apply)
      + routing_http_response_content_security_policy_header_value            = (known after apply)
      + routing_http_response_server_enabled                                  = (known after apply)
      + routing_http_response_strict_transport_security_header_value          = (known after apply)
      + routing_http_response_x_content_type_options_header_value             = (known after apply)
      + routing_http_response_x_frame_options_header_value                    = (known after apply)
      + ssl_policy                                                            = (known after apply)
      + tags_all                                                              = (known after apply)
      + tcp_idle_timeout_seconds                                              = (known after apply)

      + default_action {
          + order            = (known after apply)
          + target_group_arn = (known after apply)
          + type             = "forward"
        }
    }

  # aws_lb_listener.frontend_http will be created
  + resource "aws_lb_listener" "frontend_http" {
      + arn                                                                   = (known after apply)
      + id                                                                    = (known after apply)
      + load_balancer_arn                                                     = (known after apply)
      + port                                                                  = 80
      + protocol                                                              = "HTTP"
      + region                                                                = "ap-south-1"
      + routing_http_request_x_amzn_mtls_clientcert_header_name               = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_issuer_header_name        = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_leaf_header_name          = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_subject_header_name       = (known after apply)
      + routing_http_request_x_amzn_mtls_clientcert_validity_header_name      = (known after apply)
      + routing_http_request_x_amzn_tls_cipher_suite_header_name              = (known after apply)
      + routing_http_request_x_amzn_tls_version_header_name                   = (known after apply)
      + routing_http_response_access_control_allow_credentials_header_value   = (known after apply)
      + routing_http_response_access_control_allow_headers_header_value       = (known after apply)
      + routing_http_response_access_control_allow_methods_header_value       = (known after apply)
      + routing_http_response_access_control_allow_origin_header_value        = (known after apply)
      + routing_http_response_access_control_expose_headers_header_value      = (known after apply)
      + routing_http_response_access_control_max_age_header_value             = (known after apply)
      + routing_http_response_content_security_policy_header_value            = (known after apply)
      + routing_http_response_server_enabled                                  = (known after apply)
      + routing_http_response_strict_transport_security_header_value          = (known after apply)
      + routing_http_response_x_content_type_options_header_value             = (known after apply)
      + routing_http_response_x_frame_options_header_value                    = (known after apply)
      + ssl_policy                                                            = (known after apply)
      + tags_all                                                              = (known after apply)
      + tcp_idle_timeout_seconds                                              = (known after apply)

      + default_action {
          + order            = (known after apply)
          + target_group_arn = (known after apply)
          + type             = "forward"
        }
    }

  # aws_lb_target_group.backend_tg will be created
  + resource "aws_lb_target_group" "backend_tg" {
      + arn                                = (known after apply)
      + arn_suffix                         = (known after apply)
      + connection_termination             = (known after apply)
      + deregistration_delay               = "300"
      + id                                 = (known after apply)
      + ip_address_type                    = (known after apply)
      + lambda_multi_value_headers_enabled = false
      + load_balancer_arns                 = (known after apply)
      + load_balancing_algorithm_type      = (known after apply)
      + load_balancing_anomaly_mitigation  = (known after apply)
      + load_balancing_cross_zone_enabled  = (known after apply)
      + name                               = "backend-tg"
      + name_prefix                        = (known after apply)
      + port                               = 8000
      + preserve_client_ip                 = (known after apply)
      + protocol                           = "HTTP"
      + protocol_version                   = (known after apply)
      + proxy_protocol_v2                  = false
      + region                             = "ap-south-1"
      + slow_start                         = 0
      + tags_all                           = (known after apply)
      + target_type                        = "ip"
      + vpc_id                             = "vpc-0362005e6b6eb2070"

      + health_check {
          + enabled             = true
          + healthy_threshold   = 2
          + interval            = 30
          + matcher             = "200"
          + path                = "/health"
          + port                = "8000"
          + protocol            = "HTTP"
          + timeout             = 10
          + unhealthy_threshold = 3
        }
    }

  # aws_lb_target_group.frontend_tg will be created
  + resource "aws_lb_target_group" "frontend_tg" {
      + arn                                = (known after apply)
      + arn_suffix                         = (known after apply)
      + connection_termination             = (known after apply)
      + deregistration_delay               = "300"
      + id                                 = (known after apply)
      + ip_address_type                    = (known after apply)
      + lambda_multi_value_headers_enabled = false
      + load_balancer_arns                 = (known after apply)
      + load_balancing_algorithm_type      = (known after apply)
      + load_balancing_anomaly_mitigation  = (known after apply)
      + load_balancing_cross_zone_enabled  = (known after apply)
      + name                               = "frontend-tg"
      + name_prefix                        = (known after apply)
      + port                               = 3000
      + preserve_client_ip                 = (known after apply)
      + protocol                           = "HTTP"
      + protocol_version                   = (known after apply)
      + proxy_protocol_v2                  = false
      + region                             = "ap-south-1"
      + slow_start                         = 0
      + tags_all                           = (known after apply)
      + target_type                        = "ip"
      + vpc_id                             = "vpc-0362005e6b6eb2070"

      + health_check {
          + enabled             = true
          + healthy_threshold   = 2
          + interval            = 30
          + matcher             = "200"
          + path                = "/"
          + port                = "3000"
          + protocol            = "HTTP"
          + timeout             = 10
          + unhealthy_threshold = 3
        }
    }

  # aws_security_group.ecs_task_sg will be created
  + resource "aws_security_group" "ecs_task_sg" {
      + arn                    = (known after apply)
      + description            = "Allow traffic only from ALB"
      + egress                 = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 0
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "-1"
              + security_groups  = []
              + self             = false
              + to_port          = 0
            },
        ]
      + id                     = (known after apply)
      + ingress                = [
          + {
              + cidr_blocks      = []
              + description      = ""
              + from_port        = 3000
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = (known after apply)
              + self             = false
              + to_port          = 3000
            },
          + {
              + cidr_blocks      = []
              + description      = ""
              + from_port        = 8000
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = (known after apply)
              + self             = false
              + to_port          = 8000
            },
        ]
      + name                   = "ecs-task-security-group"
      + name_prefix            = (known after apply)
      + owner_id               = (known after apply)
      + region                 = "ap-south-1"
      + revoke_rules_on_delete = false
      + tags_all               = (known after apply)
      + vpc_id                 = "vpc-0362005e6b6eb2070"
    }

  # aws_security_group.lb_sg will be created
  + resource "aws_security_group" "lb_sg" {
      + arn                    = (known after apply)
      + description            = "Controls access to the ALB"
      + egress                 = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 0
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "-1"
              + security_groups  = []
              + self             = false
              + to_port          = 0
            },
        ]
      + id                     = (known after apply)
      + ingress                = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 8000
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = []
              + self             = false
              + to_port          = 8000
            },
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + description      = ""
              + from_port        = 80
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = []
              + self             = false
              + to_port          = 80
            },
        ]
      + name                   = "alb-security-group"
      + name_prefix            = (known after apply)
      + owner_id               = (known after apply)
      + region                 = "ap-south-1"
      + revoke_rules_on_delete = false
      + tags_all               = (known after apply)
      + vpc_id                 = "vpc-0362005e6b6eb2070"
    }

Plan: 10 to add, 0 to change, 1 to destroy.

Changes to Outputs:
  ~ alb_dns_name = "app-lb-1007430428.ap-south-1.elb.amazonaws.com" -> (known after apply)
aws_ecs_task_definition.frontend: Destroying... [id=frontend-task]
aws_lb_target_group.frontend_tg: Creating...
aws_lb_target_group.backend_tg: Creating...
aws_ecs_task_definition.frontend: Destruction complete after 0s
aws_security_group.lb_sg: Creating...
aws_lb_target_group.frontend_tg: Creation complete after 1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84]
aws_lb_target_group.backend_tg: Creation complete after 1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194]
aws_security_group.lb_sg: Creation complete after 2s [id=sg-0d65579cc29eac268]
aws_lb.main: Creating...
aws_security_group.ecs_task_sg: Creating...
aws_security_group.ecs_task_sg: Creation complete after 2s [id=sg-0db385aac8aa38c94]
aws_ecs_service.backend: Creating...
aws_lb.main: Still creating... [10s elapsed]
aws_ecs_service.backend: Still creating... [10s elapsed]
aws_lb.main: Still creating... [20s elapsed]
aws_ecs_service.backend: Still creating... [20s elapsed]
aws_lb.main: Still creating... [30s elapsed]
aws_ecs_service.backend: Still creating... [30s elapsed]
aws_lb.main: Still creating... [40s elapsed]
aws_ecs_service.backend: Still creating... [40s elapsed]
aws_lb.main: Still creating... [50s elapsed]
aws_ecs_service.backend: Still creating... [50s elapsed]
aws_lb.main: Still creating... [1m0s elapsed]
aws_ecs_service.backend: Still creating... [1m0s elapsed]
aws_lb.main: Still creating... [1m10s elapsed]
aws_ecs_service.backend: Still creating... [1m10s elapsed]
aws_lb.main: Still creating... [1m20s elapsed]
aws_ecs_service.backend: Still creating... [1m20s elapsed]
aws_lb.main: Still creating... [1m30s elapsed]
aws_ecs_service.backend: Still creating... [1m30s elapsed]
aws_lb.main: Still creating... [1m40s elapsed]
aws_ecs_service.backend: Still creating... [1m40s elapsed]
aws_lb.main: Still creating... [1m50s elapsed]
aws_ecs_service.backend: Still creating... [1m50s elapsed]
aws_lb.main: Still creating... [2m0s elapsed]
aws_ecs_service.backend: Still creating... [2m0s elapsed]
aws_lb.main: Still creating... [2m10s elapsed]
aws_ecs_service.backend: Still creating... [2m10s elapsed]
aws_lb.main: Still creating... [2m20s elapsed]
aws_ecs_service.backend: Still creating... [2m20s elapsed]
aws_lb.main: Still creating... [2m30s elapsed]
aws_ecs_service.backend: Still creating... [2m30s elapsed]
aws_lb.main: Still creating... [2m40s elapsed]
aws_ecs_service.backend: Still creating... [2m40s elapsed]
aws_lb.main: Still creating... [2m50s elapsed]
aws_ecs_service.backend: Still creating... [2m50s elapsed]
aws_lb.main: Still creating... [3m0s elapsed]
aws_lb.main: Creation complete after 3m1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c]
aws_ecs_task_definition.frontend: Creating...
aws_lb_listener.frontend_http: Creating...
aws_lb_listener.backend_http: Creating...
aws_ecs_task_definition.frontend: Creation complete after 0s [id=frontend-task]
aws_ecs_service.frontend: Creating...
aws_lb_listener.frontend_http: Creation complete after 1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/fa7c94959b030836]
aws_lb_listener.backend_http: Creation complete after 1s [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/ec6e883e82601ccb]
aws_ecs_service.frontend: Creation complete after 1s [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_ecs_service.backend: Still creating... [3m0s elapsed]
aws_ecs_service.backend: Creation complete after 3m6s [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]

Apply complete! Resources: 10 added, 0 changed, 1 destroyed.                                                                                                                                                                                
                                                                                                                                                                                                                                            
Outputs:                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                            
alb_dns_name = "app-lb-1594103982.ap-south-1.elb.amazonaws.com"                                                                                                                                                                             
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf plan -out=multiple-ec2-deployment.plan
data.aws_availability_zones.available: Reading...
aws_ecs_cluster.main: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_cloudwatch_log_group.frontend: Refreshing state... [id=/ecs/frontend-task]
aws_cloudwatch_log_group.backend: Refreshing state... [id=/ecs/backend-task]
aws_iam_role.ecs_task_execution_role: Refreshing state... [id=ecsTaskExecutionRoleUnique]
aws_vpc.main: Refreshing state... [id=vpc-0362005e6b6eb2070]
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]
aws_internet_gateway.gw: Refreshing state... [id=igw-0eb905f2278b6d8b9]
aws_lb_target_group.frontend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84]
aws_subnet.public[0]: Refreshing state... [id=subnet-0009d1bb301c6909e]
aws_lb_target_group.backend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194]
aws_subnet.public[1]: Refreshing state... [id=subnet-07e8a6c780dfa32fd]
aws_security_group.lb_sg: Refreshing state... [id=sg-0d65579cc29eac268]
aws_route.internet_access: Refreshing state... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_security_group.ecs_task_sg: Refreshing state... [id=sg-0db385aac8aa38c94]
aws_lb.main: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c]
aws_lb_listener.backend_http: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/ec6e883e82601ccb]
aws_lb_listener.frontend_http: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/fa7c94959b030836]
aws_ecs_task_definition.backend: Refreshing state... [id=backend-task]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Refreshing state... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_ecs_task_definition.frontend: Refreshing state... [id=frontend-task]
aws_ecs_service.backend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
aws_ecs_service.frontend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]

No changes. Your infrastructure matches the configuration.

Terraform has compared your real infrastructure against your configuration and found no differences, so no changes are needed.
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ tf destroy -auto-approve                 
aws_iam_role.ecs_task_execution_role: Refreshing state... [id=ecsTaskExecutionRoleUnique]
aws_ecr_repository.frontend: Refreshing state... [id=express-frontend]
aws_cloudwatch_log_group.backend: Refreshing state... [id=/ecs/backend-task]
data.aws_availability_zones.available: Reading...
aws_ecr_repository.backend: Refreshing state... [id=flask-backend]
aws_cloudwatch_log_group.frontend: Refreshing state... [id=/ecs/frontend-task]
aws_ecs_cluster.main: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_vpc.main: Refreshing state... [id=vpc-0362005e6b6eb2070]
data.aws_availability_zones.available: Read complete after 0s [id=ap-south-1]
aws_subnet.public[1]: Refreshing state... [id=subnet-07e8a6c780dfa32fd]
aws_internet_gateway.gw: Refreshing state... [id=igw-0eb905f2278b6d8b9]
aws_subnet.public[0]: Refreshing state... [id=subnet-0009d1bb301c6909e]
aws_lb_target_group.frontend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84]
aws_security_group.lb_sg: Refreshing state... [id=sg-0d65579cc29eac268]
aws_lb_target_group.backend_tg: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194]
aws_route.internet_access: Refreshing state... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_lb.main: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c]
aws_security_group.ecs_task_sg: Refreshing state... [id=sg-0db385aac8aa38c94]
aws_lb_listener.backend_http: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/ec6e883e82601ccb]
aws_lb_listener.frontend_http: Refreshing state... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/fa7c94959b030836]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Refreshing state... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_ecs_task_definition.frontend: Refreshing state... [id=frontend-task]
aws_ecs_task_definition.backend: Refreshing state... [id=backend-task]
aws_ecs_service.frontend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_ecs_service.backend: Refreshing state... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  - destroy

Terraform will perform the following actions:

  # aws_cloudwatch_log_group.backend will be destroyed
  - resource "aws_cloudwatch_log_group" "backend" {
      - arn                         = "arn:aws:logs:ap-south-1:107634107029:log-group:/ecs/backend-task" -> null
      - deletion_protection_enabled = false -> null
      - id                          = "/ecs/backend-task" -> null
      - log_group_class             = "STANDARD" -> null
      - name                        = "/ecs/backend-task" -> null
      - region                      = "ap-south-1" -> null
      - retention_in_days           = 7 -> null
      - skip_destroy                = false -> null
      - tags                        = {} -> null
      - tags_all                    = {} -> null
    }

  # aws_cloudwatch_log_group.frontend will be destroyed
  - resource "aws_cloudwatch_log_group" "frontend" {
      - arn                         = "arn:aws:logs:ap-south-1:107634107029:log-group:/ecs/frontend-task" -> null
      - deletion_protection_enabled = false -> null
      - id                          = "/ecs/frontend-task" -> null
      - log_group_class             = "STANDARD" -> null
      - name                        = "/ecs/frontend-task" -> null
      - region                      = "ap-south-1" -> null
      - retention_in_days           = 7 -> null
      - skip_destroy                = false -> null
      - tags                        = {} -> null
      - tags_all                    = {} -> null
    }

  # aws_ecr_repository.backend will be destroyed
  - resource "aws_ecr_repository" "backend" {
      - arn                  = "arn:aws:ecr:ap-south-1:107634107029:repository/flask-backend" -> null
      - force_delete         = true -> null
      - id                   = "flask-backend" -> null
      - image_tag_mutability = "MUTABLE" -> null
      - name                 = "flask-backend" -> null
      - region               = "ap-south-1" -> null
      - registry_id          = "107634107029" -> null
      - repository_url       = "107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend" -> null
      - tags                 = {} -> null
      - tags_all             = {} -> null

      - encryption_configuration {
          - encryption_type = "AES256" -> null
        }

      - image_scanning_configuration {
          - scan_on_push = false -> null
        }
    }

  # aws_ecr_repository.frontend will be destroyed
  - resource "aws_ecr_repository" "frontend" {
      - arn                  = "arn:aws:ecr:ap-south-1:107634107029:repository/express-frontend" -> null
      - force_delete         = true -> null
      - id                   = "express-frontend" -> null
      - image_tag_mutability = "MUTABLE" -> null
      - name                 = "express-frontend" -> null
      - region               = "ap-south-1" -> null
      - registry_id          = "107634107029" -> null
      - repository_url       = "107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend" -> null
      - tags                 = {} -> null
      - tags_all             = {} -> null

      - encryption_configuration {
          - encryption_type = "AES256" -> null
        }

      - image_scanning_configuration {
          - scan_on_push = false -> null
        }
    }

  # aws_ecs_cluster.main will be destroyed
  - resource "aws_ecs_cluster" "main" {
      - arn      = "arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster" -> null
      - id       = "arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster" -> null
      - name     = "app-cluster" -> null
      - region   = "ap-south-1" -> null
      - tags     = {} -> null
      - tags_all = {} -> null

      - setting {
          - name  = "containerInsights" -> null
          - value = "disabled" -> null
        }
    }

  # aws_ecs_service.backend will be destroyed
  - resource "aws_ecs_service" "backend" {
      - arn                                = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service" -> null
      - availability_zone_rebalancing      = "ENABLED" -> null
      - cluster                            = "arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster" -> null
      - deployment_maximum_percent         = 200 -> null
      - deployment_minimum_healthy_percent = 100 -> null
      - desired_count                      = 1 -> null
      - enable_ecs_managed_tags            = false -> null
      - enable_execute_command             = false -> null
      - health_check_grace_period_seconds  = 180 -> null
      - iam_role                           = "/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS" -> null
      - id                                 = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service" -> null
      - launch_type                        = "FARGATE" -> null
      - name                               = "backend-service" -> null
      - platform_version                   = "LATEST" -> null
      - propagate_tags                     = "NONE" -> null
      - region                             = "ap-south-1" -> null
      - scheduling_strategy                = "REPLICA" -> null
      - tags                               = {} -> null
      - tags_all                           = {} -> null
      - task_definition                    = "arn:aws:ecs:ap-south-1:107634107029:task-definition/backend-task:3" -> null
      - triggers                           = {} -> null
      - wait_for_steady_state              = false -> null

      - deployment_circuit_breaker {
          - enable   = false -> null
          - rollback = false -> null
        }

      - deployment_configuration {
          - bake_time_in_minutes = "0" -> null
          - strategy             = "ROLLING" -> null
        }

      - deployment_controller {
          - type = "ECS" -> null
        }

      - load_balancer {
          - container_name   = "backend" -> null
          - container_port   = 8000 -> null
          - target_group_arn = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194" -> null
        }

      - network_configuration {
          - assign_public_ip = true -> null
          - security_groups  = [
              - "sg-0db385aac8aa38c94",
            ] -> null
          - subnets          = [
              - "subnet-0009d1bb301c6909e",
              - "subnet-07e8a6c780dfa32fd",
            ] -> null
        }
    }

  # aws_ecs_service.frontend will be destroyed
  - resource "aws_ecs_service" "frontend" {
      - arn                                = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service" -> null
      - availability_zone_rebalancing      = "ENABLED" -> null
      - cluster                            = "arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster" -> null
      - deployment_maximum_percent         = 200 -> null
      - deployment_minimum_healthy_percent = 100 -> null
      - desired_count                      = 1 -> null
      - enable_ecs_managed_tags            = false -> null
      - enable_execute_command             = false -> null
      - health_check_grace_period_seconds  = 180 -> null
      - iam_role                           = "/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS" -> null
      - id                                 = "arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service" -> null
      - launch_type                        = "FARGATE" -> null
      - name                               = "frontend-service" -> null
      - platform_version                   = "LATEST" -> null
      - propagate_tags                     = "NONE" -> null
      - region                             = "ap-south-1" -> null
      - scheduling_strategy                = "REPLICA" -> null
      - tags                               = {} -> null
      - tags_all                           = {} -> null
      - task_definition                    = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task:5" -> null
      - triggers                           = {} -> null
      - wait_for_steady_state              = false -> null

      - deployment_circuit_breaker {
          - enable   = false -> null
          - rollback = false -> null
        }

      - deployment_configuration {
          - bake_time_in_minutes = "0" -> null
          - strategy             = "ROLLING" -> null
        }

      - deployment_controller {
          - type = "ECS" -> null
        }

      - load_balancer {
          - container_name   = "frontend" -> null
          - container_port   = 3000 -> null
          - target_group_arn = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84" -> null
        }

      - network_configuration {
          - assign_public_ip = true -> null
          - security_groups  = [
              - "sg-0db385aac8aa38c94",
            ] -> null
          - subnets          = [
              - "subnet-0009d1bb301c6909e",
              - "subnet-07e8a6c780dfa32fd",
            ] -> null
        }
    }

  # aws_ecs_task_definition.backend will be destroyed
  - resource "aws_ecs_task_definition" "backend" {
      - arn                      = "arn:aws:ecs:ap-south-1:107634107029:task-definition/backend-task:3" -> null
      - arn_without_revision     = "arn:aws:ecs:ap-south-1:107634107029:task-definition/backend-task" -> null
      - container_definitions    = jsonencode(
            [
              - {
                  - environment      = []
                  - essential        = true
                  - image            = "107634107029.dkr.ecr.ap-south-1.amazonaws.com/flask-backend"
                  - logConfiguration = {
                      - logDriver = "awslogs"
                      - options   = {
                          - awslogs-group         = "/ecs/backend-task"
                          - awslogs-region        = "ap-south-1"
                          - awslogs-stream-prefix = "ecs"
                        }
                    }
                  - mountPoints      = []
                  - name             = "backend"
                  - portMappings     = [
                      - {
                          - containerPort = 8000
                          - hostPort      = 8000
                          - protocol      = "tcp"
                        },
                    ]
                  - systemControls   = []
                  - volumesFrom      = []
                },
            ]
        ) -> null
      - cpu                      = "256" -> null
      - enable_fault_injection   = false -> null
      - execution_role_arn       = "arn:aws:iam::107634107029:role/ecsTaskExecutionRoleUnique" -> null
      - family                   = "backend-task" -> null
      - id                       = "backend-task" -> null
      - memory                   = "512" -> null
      - network_mode             = "awsvpc" -> null
      - region                   = "ap-south-1" -> null
      - requires_compatibilities = [
          - "FARGATE",
        ] -> null
      - revision                 = 3 -> null
      - skip_destroy             = false -> null
      - tags                     = {} -> null
      - tags_all                 = {} -> null
      - track_latest             = false -> null
    }

  # aws_ecs_task_definition.frontend will be destroyed
  - resource "aws_ecs_task_definition" "frontend" {
      - arn                      = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task:5" -> null
      - arn_without_revision     = "arn:aws:ecs:ap-south-1:107634107029:task-definition/frontend-task" -> null
      - container_definitions    = jsonencode(
            [
              - {
                  - environment      = [
                      - {
                          - name  = "BACKEND_URL"
                          - value = "http://app-lb-1594103982.ap-south-1.elb.amazonaws.com:8000/people"
                        },
                    ]
                  - essential        = true
                  - image            = "107634107029.dkr.ecr.ap-south-1.amazonaws.com/express-frontend"
                  - logConfiguration = {
                      - logDriver = "awslogs"
                      - options   = {
                          - awslogs-group         = "/ecs/frontend-task"
                          - awslogs-region        = "ap-south-1"
                          - awslogs-stream-prefix = "ecs"
                        }
                    }
                  - mountPoints      = []
                  - name             = "frontend"
                  - portMappings     = [
                      - {
                          - containerPort = 3000
                          - hostPort      = 3000
                          - protocol      = "tcp"
                        },
                    ]
                  - systemControls   = []
                  - volumesFrom      = []
                },
            ]
        ) -> null
      - cpu                      = "256" -> null
      - enable_fault_injection   = false -> null
      - execution_role_arn       = "arn:aws:iam::107634107029:role/ecsTaskExecutionRoleUnique" -> null
      - family                   = "frontend-task" -> null
      - id                       = "frontend-task" -> null
      - memory                   = "512" -> null
      - network_mode             = "awsvpc" -> null
      - region                   = "ap-south-1" -> null
      - requires_compatibilities = [
          - "FARGATE",
        ] -> null
      - revision                 = 5 -> null
      - skip_destroy             = false -> null
      - tags                     = {} -> null
      - tags_all                 = {} -> null
      - track_latest             = false -> null
    }

  # aws_iam_role.ecs_task_execution_role will be destroyed
  - resource "aws_iam_role" "ecs_task_execution_role" {
      - arn                   = "arn:aws:iam::107634107029:role/ecsTaskExecutionRoleUnique" -> null
      - assume_role_policy    = jsonencode(
            {
              - Statement = [
                  - {
                      - Action    = "sts:AssumeRole"
                      - Effect    = "Allow"
                      - Principal = {
                          - Service = "ecs-tasks.amazonaws.com"
                        }
                    },
                ]
              - Version   = "2012-10-17"
            }
        ) -> null
      - create_date           = "2026-01-15T05:57:06Z" -> null
      - force_detach_policies = false -> null
      - id                    = "ecsTaskExecutionRoleUnique" -> null
      - managed_policy_arns   = [
          - "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy",
        ] -> null
      - max_session_duration  = 3600 -> null
      - name                  = "ecsTaskExecutionRoleUnique" -> null
      - path                  = "/" -> null
      - tags                  = {} -> null
      - tags_all              = {} -> null
      - unique_id             = "AROARSD36EKK3K6RWKDBL" -> null
    }

  # aws_iam_role_policy_attachment.ecs_task_execution_role_policy will be destroyed
  - resource "aws_iam_role_policy_attachment" "ecs_task_execution_role_policy" {
      - id         = "ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy" -> null
      - policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy" -> null
      - role       = "ecsTaskExecutionRoleUnique" -> null
    }

  # aws_internet_gateway.gw will be destroyed
  - resource "aws_internet_gateway" "gw" {
      - arn      = "arn:aws:ec2:ap-south-1:107634107029:internet-gateway/igw-0eb905f2278b6d8b9" -> null
      - id       = "igw-0eb905f2278b6d8b9" -> null
      - owner_id = "107634107029" -> null
      - region   = "ap-south-1" -> null
      - tags     = {} -> null
      - tags_all = {} -> null
      - vpc_id   = "vpc-0362005e6b6eb2070" -> null
    }

  # aws_lb.main will be destroyed
  - resource "aws_lb" "main" {
      - arn                                         = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c" -> null
      - arn_suffix                                  = "app/app-lb/dd53e6bb0e46d51c" -> null
      - client_keep_alive                           = 3600 -> null
      - desync_mitigation_mode                      = "defensive" -> null
      - dns_name                                    = "app-lb-1594103982.ap-south-1.elb.amazonaws.com" -> null
      - drop_invalid_header_fields                  = false -> null
      - enable_cross_zone_load_balancing            = true -> null
      - enable_deletion_protection                  = false -> null
      - enable_http2                                = true -> null
      - enable_tls_version_and_cipher_suite_headers = false -> null
      - enable_waf_fail_open                        = false -> null
      - enable_xff_client_port                      = false -> null
      - enable_zonal_shift                          = false -> null
      - id                                          = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c" -> null
      - idle_timeout                                = 60 -> null
      - internal                                    = false -> null
      - ip_address_type                             = "ipv4" -> null
      - load_balancer_type                          = "application" -> null
      - name                                        = "app-lb" -> null
      - preserve_host_header                        = false -> null
      - region                                      = "ap-south-1" -> null
      - security_groups                             = [
          - "sg-0d65579cc29eac268",
        ] -> null
      - subnets                                     = [
          - "subnet-0009d1bb301c6909e",
          - "subnet-07e8a6c780dfa32fd",
        ] -> null
      - tags                                        = {} -> null
      - tags_all                                    = {} -> null
      - vpc_id                                      = "vpc-0362005e6b6eb2070" -> null
      - xff_header_processing_mode                  = "append" -> null
      - zone_id                                     = "ZP97RAFLXTNZK" -> null

      - access_logs {
          - enabled = false -> null
        }

      - connection_logs {
          - enabled = false -> null
        }

      - health_check_logs {
          - enabled = false -> null
        }

      - subnet_mapping {
          - subnet_id = "subnet-0009d1bb301c6909e" -> null
        }
      - subnet_mapping {
          - subnet_id = "subnet-07e8a6c780dfa32fd" -> null
        }
    }

  # aws_lb_listener.backend_http will be destroyed
  - resource "aws_lb_listener" "backend_http" {
      - arn                                  = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/ec6e883e82601ccb" -> null
      - id                                   = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/ec6e883e82601ccb" -> null
      - load_balancer_arn                    = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c" -> null
      - port                                 = 8000 -> null
      - protocol                             = "HTTP" -> null
      - region                               = "ap-south-1" -> null
      - routing_http_response_server_enabled = true -> null
      - tags                                 = {} -> null
      - tags_all                             = {} -> null

      - default_action {
          - order            = 1 -> null
          - target_group_arn = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194" -> null
          - type             = "forward" -> null
        }
    }

  # aws_lb_listener.frontend_http will be destroyed
  - resource "aws_lb_listener" "frontend_http" {
      - arn                                  = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/fa7c94959b030836" -> null
      - id                                   = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/fa7c94959b030836" -> null
      - load_balancer_arn                    = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c" -> null
      - port                                 = 80 -> null
      - protocol                             = "HTTP" -> null
      - region                               = "ap-south-1" -> null
      - routing_http_response_server_enabled = true -> null
      - tags                                 = {} -> null
      - tags_all                             = {} -> null

      - default_action {
          - order            = 1 -> null
          - target_group_arn = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84" -> null
          - type             = "forward" -> null
        }
    }

  # aws_lb_target_group.backend_tg will be destroyed
  - resource "aws_lb_target_group" "backend_tg" {
      - arn                                = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194" -> null
      - arn_suffix                         = "targetgroup/backend-tg/d43d3d3869c81194" -> null
      - deregistration_delay               = "300" -> null
      - id                                 = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194" -> null
      - ip_address_type                    = "ipv4" -> null
      - lambda_multi_value_headers_enabled = false -> null
      - load_balancer_arns                 = [
          - "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c",
        ] -> null
      - load_balancing_algorithm_type      = "round_robin" -> null
      - load_balancing_anomaly_mitigation  = "off" -> null
      - load_balancing_cross_zone_enabled  = "use_load_balancer_configuration" -> null
      - name                               = "backend-tg" -> null
      - port                               = 8000 -> null
      - protocol                           = "HTTP" -> null
      - protocol_version                   = "HTTP1" -> null
      - proxy_protocol_v2                  = false -> null
      - region                             = "ap-south-1" -> null
      - slow_start                         = 0 -> null
      - tags                               = {} -> null
      - tags_all                           = {} -> null
      - target_control_port                = 0 -> null
      - target_type                        = "ip" -> null
      - vpc_id                             = "vpc-0362005e6b6eb2070" -> null

      - health_check {
          - enabled             = true -> null
          - healthy_threshold   = 2 -> null
          - interval            = 30 -> null
          - matcher             = "200" -> null
          - path                = "/health" -> null
          - port                = "8000" -> null
          - protocol            = "HTTP" -> null
          - timeout             = 10 -> null
          - unhealthy_threshold = 3 -> null
        }

      - stickiness {
          - cookie_duration = 86400 -> null
          - enabled         = false -> null
          - type            = "lb_cookie" -> null
        }

      - target_failover {}

      - target_group_health {
          - dns_failover {
              - minimum_healthy_targets_count      = "1" -> null
              - minimum_healthy_targets_percentage = "off" -> null
            }
          - unhealthy_state_routing {
              - minimum_healthy_targets_count      = 1 -> null
              - minimum_healthy_targets_percentage = "off" -> null
            }
        }

      - target_health_state {}
    }

  # aws_lb_target_group.frontend_tg will be destroyed
  - resource "aws_lb_target_group" "frontend_tg" {
      - arn                                = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84" -> null
      - arn_suffix                         = "targetgroup/frontend-tg/2aa9e8b1b250dd84" -> null
      - deregistration_delay               = "300" -> null
      - id                                 = "arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84" -> null
      - ip_address_type                    = "ipv4" -> null
      - lambda_multi_value_headers_enabled = false -> null
      - load_balancer_arns                 = [
          - "arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c",
        ] -> null
      - load_balancing_algorithm_type      = "round_robin" -> null
      - load_balancing_anomaly_mitigation  = "off" -> null
      - load_balancing_cross_zone_enabled  = "use_load_balancer_configuration" -> null
      - name                               = "frontend-tg" -> null
      - port                               = 3000 -> null
      - protocol                           = "HTTP" -> null
      - protocol_version                   = "HTTP1" -> null
      - proxy_protocol_v2                  = false -> null
      - region                             = "ap-south-1" -> null
      - slow_start                         = 0 -> null
      - tags                               = {} -> null
      - tags_all                           = {} -> null
      - target_control_port                = 0 -> null
      - target_type                        = "ip" -> null
      - vpc_id                             = "vpc-0362005e6b6eb2070" -> null

      - health_check {
          - enabled             = true -> null
          - healthy_threshold   = 2 -> null
          - interval            = 30 -> null
          - matcher             = "200" -> null
          - path                = "/" -> null
          - port                = "3000" -> null
          - protocol            = "HTTP" -> null
          - timeout             = 10 -> null
          - unhealthy_threshold = 3 -> null
        }

      - stickiness {
          - cookie_duration = 86400 -> null
          - enabled         = false -> null
          - type            = "lb_cookie" -> null
        }

      - target_failover {}

      - target_group_health {
          - dns_failover {
              - minimum_healthy_targets_count      = "1" -> null
              - minimum_healthy_targets_percentage = "off" -> null
            }
          - unhealthy_state_routing {
              - minimum_healthy_targets_count      = 1 -> null
              - minimum_healthy_targets_percentage = "off" -> null
            }
        }

      - target_health_state {}
    }

  # aws_route.internet_access will be destroyed
  - resource "aws_route" "internet_access" {
      - destination_cidr_block = "0.0.0.0/0" -> null
      - gateway_id             = "igw-0eb905f2278b6d8b9" -> null
      - id                     = "r-rtb-0d716ebe8dfc7060f1080289494" -> null
      - origin                 = "CreateRoute" -> null
      - region                 = "ap-south-1" -> null
      - route_table_id         = "rtb-0d716ebe8dfc7060f" -> null
      - state                  = "active" -> null
    }

  # aws_security_group.ecs_task_sg will be destroyed
  - resource "aws_security_group" "ecs_task_sg" {
      - arn                    = "arn:aws:ec2:ap-south-1:107634107029:security-group/sg-0db385aac8aa38c94" -> null
      - description            = "Allow traffic only from ALB" -> null
      - egress                 = [
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - description      = ""
              - from_port        = 0
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "-1"
              - security_groups  = []
              - self             = false
              - to_port          = 0
            },
        ] -> null
      - id                     = "sg-0db385aac8aa38c94" -> null
      - ingress                = [
          - {
              - cidr_blocks      = []
              - description      = ""
              - from_port        = 3000
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "tcp"
              - security_groups  = [
                  - "sg-0d65579cc29eac268",
                ]
              - self             = false
              - to_port          = 3000
            },
          - {
              - cidr_blocks      = []
              - description      = ""
              - from_port        = 8000
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "tcp"
              - security_groups  = [
                  - "sg-0d65579cc29eac268",
                ]
              - self             = false
              - to_port          = 8000
            },
        ] -> null
      - name                   = "ecs-task-security-group" -> null
      - owner_id               = "107634107029" -> null
      - region                 = "ap-south-1" -> null
      - revoke_rules_on_delete = false -> null
      - tags                   = {} -> null
      - tags_all               = {} -> null
      - vpc_id                 = "vpc-0362005e6b6eb2070" -> null
    }

  # aws_security_group.lb_sg will be destroyed
  - resource "aws_security_group" "lb_sg" {
      - arn                    = "arn:aws:ec2:ap-south-1:107634107029:security-group/sg-0d65579cc29eac268" -> null
      - description            = "Controls access to the ALB" -> null
      - egress                 = [
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - description      = ""
              - from_port        = 0
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "-1"
              - security_groups  = []
              - self             = false
              - to_port          = 0
            },
        ] -> null
      - id                     = "sg-0d65579cc29eac268" -> null
      - ingress                = [
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - description      = ""
              - from_port        = 8000
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "tcp"
              - security_groups  = []
              - self             = false
              - to_port          = 8000
            },
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - description      = ""
              - from_port        = 80
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "tcp"
              - security_groups  = []
              - self             = false
              - to_port          = 80
            },
        ] -> null
      - name                   = "alb-security-group" -> null
      - owner_id               = "107634107029" -> null
      - region                 = "ap-south-1" -> null
      - revoke_rules_on_delete = false -> null
      - tags                   = {} -> null
      - tags_all               = {} -> null
      - vpc_id                 = "vpc-0362005e6b6eb2070" -> null
    }

  # aws_subnet.public[0] will be destroyed
  - resource "aws_subnet" "public" {
      - arn                                            = "arn:aws:ec2:ap-south-1:107634107029:subnet/subnet-0009d1bb301c6909e" -> null
      - assign_ipv6_address_on_creation                = false -> null
      - availability_zone                              = "ap-south-1a" -> null
      - availability_zone_id                           = "aps1-az1" -> null
      - cidr_block                                     = "10.0.0.0/24" -> null
      - enable_dns64                                   = false -> null
      - enable_lni_at_device_index                     = 0 -> null
      - enable_resource_name_dns_a_record_on_launch    = false -> null
      - enable_resource_name_dns_aaaa_record_on_launch = false -> null
      - id                                             = "subnet-0009d1bb301c6909e" -> null
      - ipv6_native                                    = false -> null
      - map_customer_owned_ip_on_launch                = false -> null
      - map_public_ip_on_launch                        = true -> null
      - owner_id                                       = "107634107029" -> null
      - private_dns_hostname_type_on_launch            = "ip-name" -> null
      - region                                         = "ap-south-1" -> null
      - tags                                           = {
          - "Name" = "public-subnet-0"
        } -> null
      - tags_all                                       = {
          - "Name" = "public-subnet-0"
        } -> null
      - vpc_id                                         = "vpc-0362005e6b6eb2070" -> null
    }

  # aws_subnet.public[1] will be destroyed
  - resource "aws_subnet" "public" {
      - arn                                            = "arn:aws:ec2:ap-south-1:107634107029:subnet/subnet-07e8a6c780dfa32fd" -> null
      - assign_ipv6_address_on_creation                = false -> null
      - availability_zone                              = "ap-south-1b" -> null
      - availability_zone_id                           = "aps1-az3" -> null
      - cidr_block                                     = "10.0.1.0/24" -> null
      - enable_dns64                                   = false -> null
      - enable_lni_at_device_index                     = 0 -> null
      - enable_resource_name_dns_a_record_on_launch    = false -> null
      - enable_resource_name_dns_aaaa_record_on_launch = false -> null
      - id                                             = "subnet-07e8a6c780dfa32fd" -> null
      - ipv6_native                                    = false -> null
      - map_customer_owned_ip_on_launch                = false -> null
      - map_public_ip_on_launch                        = true -> null
      - owner_id                                       = "107634107029" -> null
      - private_dns_hostname_type_on_launch            = "ip-name" -> null
      - region                                         = "ap-south-1" -> null
      - tags                                           = {
          - "Name" = "public-subnet-1"
        } -> null
      - tags_all                                       = {
          - "Name" = "public-subnet-1"
        } -> null
      - vpc_id                                         = "vpc-0362005e6b6eb2070" -> null
    }

  # aws_vpc.main will be destroyed
  - resource "aws_vpc" "main" {
      - arn                                  = "arn:aws:ec2:ap-south-1:107634107029:vpc/vpc-0362005e6b6eb2070" -> null
      - assign_generated_ipv6_cidr_block     = false -> null
      - cidr_block                           = "10.0.0.0/16" -> null
      - default_network_acl_id               = "acl-0d80b5127dd070ef6" -> null
      - default_route_table_id               = "rtb-0d716ebe8dfc7060f" -> null
      - default_security_group_id            = "sg-09c3fc9cac66f0ef1" -> null
      - dhcp_options_id                      = "dopt-0f6f5b0087b82b0f3" -> null
      - enable_dns_hostnames                 = true -> null
      - enable_dns_support                   = true -> null
      - enable_network_address_usage_metrics = false -> null
      - id                                   = "vpc-0362005e6b6eb2070" -> null
      - instance_tenancy                     = "default" -> null
      - ipv6_netmask_length                  = 0 -> null
      - main_route_table_id                  = "rtb-0d716ebe8dfc7060f" -> null
      - owner_id                             = "107634107029" -> null
      - region                               = "ap-south-1" -> null
      - tags                                 = {
          - "Name" = "ecs-vpc"
        } -> null
      - tags_all                             = {
          - "Name" = "ecs-vpc"
        } -> null
    }

Plan: 0 to add, 0 to change, 23 to destroy.

Changes to Outputs:
  - alb_dns_name = "app-lb-1594103982.ap-south-1.elb.amazonaws.com" -> null
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Destroying... [id=ecsTaskExecutionRoleUnique/arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy]
aws_lb_listener.frontend_http: Destroying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/fa7c94959b030836]
aws_route.internet_access: Destroying... [id=r-rtb-0d716ebe8dfc7060f1080289494]
aws_ecs_service.backend: Destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service]
aws_ecs_service.frontend: Destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service]
aws_lb_listener.backend_http: Destroying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:listener/app/app-lb/dd53e6bb0e46d51c/ec6e883e82601ccb]
aws_lb_listener.frontend_http: Destruction complete after 0s
aws_lb_listener.backend_http: Destruction complete after 1s
aws_route.internet_access: Destruction complete after 1s
aws_internet_gateway.gw: Destroying... [id=igw-0eb905f2278b6d8b9]
aws_iam_role_policy_attachment.ecs_task_execution_role_policy: Destruction complete after 1s
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 10s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 10s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 10s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 20s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 20s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 20s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 30s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 30s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 30s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 40s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 40s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 40s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 50s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 50s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 50s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 1m0s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 1m0s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 1m0s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 1m10s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 1m10s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 1m10s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 1m20s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 1m20s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 1m20s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 1m30s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 1m30s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 1m30s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 1m41s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 1m41s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 1m40s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 1m51s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 1m51s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 1m50s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 2m1s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 2m1s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 2m0s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 2m11s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 2m11s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 2m10s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 2m21s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 2m21s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 2m20s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 2m31s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 2m31s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 2m30s elapsed]
aws_ecs_service.frontend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/frontend-service, 2m41s elapsed]
aws_ecs_service.backend: Still destroying... [id=arn:aws:ecs:ap-south-1:107634107029:service/app-cluster/backend-service, 2m41s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 2m40s elapsed]
aws_ecs_service.frontend: Destruction complete after 2m43s
aws_ecs_service.backend: Destruction complete after 2m43s
aws_security_group.ecs_task_sg: Destroying... [id=sg-0db385aac8aa38c94]
aws_ecs_task_definition.backend: Destroying... [id=backend-task]
aws_lb_target_group.frontend_tg: Destroying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/frontend-tg/2aa9e8b1b250dd84]
aws_ecs_cluster.main: Destroying... [id=arn:aws:ecs:ap-south-1:107634107029:cluster/app-cluster]
aws_ecs_task_definition.frontend: Destroying... [id=frontend-task]
aws_lb_target_group.backend_tg: Destroying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:targetgroup/backend-tg/d43d3d3869c81194]
aws_ecs_task_definition.backend: Destruction complete after 0s
aws_cloudwatch_log_group.backend: Destroying... [id=/ecs/backend-task]
aws_ecr_repository.backend: Destroying... [id=flask-backend]
aws_ecs_task_definition.frontend: Destruction complete after 0s
aws_iam_role.ecs_task_execution_role: Destroying... [id=ecsTaskExecutionRoleUnique]
aws_lb.main: Destroying... [id=arn:aws:elasticloadbalancing:ap-south-1:107634107029:loadbalancer/app/app-lb/dd53e6bb0e46d51c]
aws_ecr_repository.frontend: Destroying... [id=express-frontend]
aws_ecs_cluster.main: Destruction complete after 0s
aws_lb_target_group.frontend_tg: Destruction complete after 0s
aws_lb_target_group.backend_tg: Destruction complete after 0s
aws_cloudwatch_log_group.frontend: Destroying... [id=/ecs/frontend-task]
aws_cloudwatch_log_group.backend: Destruction complete after 0s
aws_cloudwatch_log_group.frontend: Destruction complete after 0s
aws_ecr_repository.frontend: Destruction complete after 0s
aws_ecr_repository.backend: Destruction complete after 0s
aws_security_group.ecs_task_sg: Destruction complete after 0s
aws_iam_role.ecs_task_execution_role: Destruction complete after 1s
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 2m50s elapsed]
aws_lb.main: Still destroying... [id=arn:aws:elasticloadbalancing:ap-south-1...adbalancer/app/app-lb/dd53e6bb0e46d51c, 10s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 3m0s elapsed]
aws_lb.main: Still destroying... [id=arn:aws:elasticloadbalancing:ap-south-1...adbalancer/app/app-lb/dd53e6bb0e46d51c, 20s elapsed]
aws_internet_gateway.gw: Still destroying... [id=igw-0eb905f2278b6d8b9, 3m10s elapsed]
aws_lb.main: Still destroying... [id=arn:aws:elasticloadbalancing:ap-south-1...adbalancer/app/app-lb/dd53e6bb0e46d51c, 30s elapsed]
aws_lb.main: Destruction complete after 36s
aws_subnet.public[1]: Destroying... [id=subnet-07e8a6c780dfa32fd]
aws_subnet.public[0]: Destroying... [id=subnet-0009d1bb301c6909e]
aws_security_group.lb_sg: Destroying... [id=sg-0d65579cc29eac268]
aws_subnet.public[1]: Destruction complete after 1s
aws_subnet.public[0]: Destruction complete after 1s
aws_security_group.lb_sg: Destruction complete after 1s
aws_internet_gateway.gw: Destruction complete after 3m19s
aws_vpc.main: Destroying... [id=vpc-0362005e6b6eb2070]
aws_vpc.main: Destruction complete after 1s

Destroy complete! Resources: 23 destroyed.                                                                                                                                                                                                  
                                                                                                                                                                                                                                            
┌──(kali㉿kali)-[~/Desktop/tutedude/terraform/tf-ecs-ecr-vpc-alb-instance]
└─$ 
